# mkdir /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34
# cd /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34

# extract UKBB-genotyped SNPs in entire TAD

# mkdir /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps
# cd ukbb_genotyped_snps

# awk 'BEGIN{OFS="\t"} ($3==1){print $1,$1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt > ukbb_bca_cases.indiv
# awk 'BEGIN{OFS="\t"} ($3==0){print $1,$1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt > ukbb_bca_controls.indiv

# bsub -P SJLIFE -J ukbb_hybrid_haplotype2.chr11.68850000-69500000 -oo ukbb_hybrid_haplotype2.chr11.68850000-69500000.out -eo ukbb_hybrid_haplotype2.chr11.68850000-69500000.err -R "rusage[mem=20000]" "sh /home/wletsou/scripts/ukbb_hybrid_haplotype2.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv 11 68850000,69500000 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/biobank/gds/ukb.bca.hap/ukb.bca.hap.chr11.new.vcf.gz"

# cd /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34

# vcf and haplotypes for Phase 1

# get genotyped SNPs in region
# awk 'BEGIN{OFS="\t"} ($2>=69231642 && $2<=69431642){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > ukbb_snp_list.chr11.69231642-69431642.txt

# check that SNPs have good "imputation" quality
# awk 'NR==FNR{snp[$1]; next} ($8 in snp && $15==1){print $8}' ukbb_snp_list.chr11.69231642-69431642.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info > ukbb_snp_list.chr11.69231642-69431642.tmp
# test -f ukbb_snp_list.chr11.69231642-69431642.tmp && mv ukbb_snp_list.chr11.69231642-69431642.tmp ukbb_snp_list.chr11.69231642-69431642.txt

# awk 'BEGIN{OFS="\t"} ($3==1){print $1,$1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt > ukbb_bca_cases.indiv
# awk 'BEGIN{OFS="\t"} ($3==0){print $1,$1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt > ukbb_bca_controls.indiv

# vcf file for UKBB
# bsub -P SJLIFE -J ukbb_topmed_merge.chr11.69231642-69431642 -oo ukbb_topmed_merge.chr11.69231642-69431642.out -eo ukbb_topmed_merge.chr11.69231642-69431642.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_topmed_merge.sh ukbb_snp_list.chr11.69231642-69431642.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 69231642,69431642 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11"

# vcf file for dbGaP
# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.69231642-69431642 -oo dbgap_haplotype_merge.chr11.69231642-69431642.out -eo dbgap_haplotype_merge.chr11.69231642-69431642.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" ukbb_snp_list.chr11.69231642-69431642.txt 11 69231642,69431642 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.69231642-69431642.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.69231642-69431642.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# first round of overlaps
# bsub -P SJLIFE -J ukbb_bca_overlap.chr11.69231642-69431642 -oo ukbb_bca_overlap.chr11.69231642-69431642.out -eo ukbb_bca_overlap.chr11.69231642-69431642.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_submission13.sh ukbb_bca_cases,ukbb_bca_controls,dbgap28544_cases,dbgap28544_controls 11 69231642,69431642 \"\" ukbb_snp_list.chr11.69231642-69431642.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.69231642-69431642.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 0.00000001 \"\" \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts"

# sample of all cases and controls (for LD calculations)
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt

# set a threshold for remaining overlaps
# mv Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt

# awk 'BEGIN{OFS="\t"} NR==FNR{count[$2]=$1; next} ($1 in count){print count[$1],$1}' Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt <(awk '($5+0<9.75e-10){print $1}' Pattern_differences.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.p_vals.txt) > Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.tmp

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.tmp Pattern_combined.Iteration000.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt

# Begin iterations:
# bsub -P SJLIFE -J pattern_overlap_iterate3.ukbb_bca_cases.chr11.69231642-69431642 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/pattern_overlap_iterate3.ukbb_bca_cases.chr11.69231642-69431642.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/pattern_overlap_iterate3.ukbb_bca_cases.chr11.69231642-69431642.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/pattern_overlap_iterate3.sh haplotype_estimates.ukbb_bca_cases.chr11.69231642-69431642.txt,haplotype_estimates.ukbb_bca_controls.chr11.69231642-69431642.txt 11 69231642,69431642 100 50 2 2,j \"\" \"ukbb_bca_cases\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts"

# sh /home/wletsou/scripts/ukbb_pattern_count_summary.sh ukbb_bca_cases 11 69231642,69431642 2,j

# awk '{printf "%s & $%s$ & $%s$ \\\\\n",$1+0,$2,$4}' Pattern_counts.ukbb_bca_cases.chr11.69231642-69431642_2,j.txt # latex table

# p < 1e-, translated in parallel
# test -f fisher_exact.ukbb_bca_cases.Results.txt && rm fisher_exact.ukbb_bca_cases.Results.txt; touch fisher_exact.ukbb_bca_cases.Results.txt; for file in fisher_exact.ukbb_bca_cases.Iteration*.txt; do awk '($6+0<1e-17){print $0}' $file >> fisher_exact.ukbb_bca_cases.Results.txt; done;

# bsub -P SJLIFE -J ukbb_haplotype_translate2_sub -oo ukbb_haplotype_translate2_sub.out -eo ukbb_haplotype_translate2_sub.err -R "rusage[mem=256]" -q standard "sh /home/wletsou/scripts/ukbb_haplotype_translate2_sub.sh haplotype_estimates.ukbb_bca_cases.chr11.69231642-69431642.txt fisher_exact.ukbb_bca_cases.Results.txt 50"

# bsub -P SJLIFE -J ukbb_haplotype_model9_sub -oo ukbb_haplotype_model9_sub.out -eo ukbb_haplotype_model9_sub.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt fisher_exact.ukbb_bca_cases.Results.translated.txt \"\" \"\" \"\" 11 69231642,69431642 50 \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_model9_iterate -oo ukbb_haplotype_model9_iterate.out -eo ukbb_haplotype_model9_iterate.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_iterate.sh allele_counts.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt \"\" \"\" 0.01 Significant_patterns.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts"

# awk 'BEGIN{n=split("rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?",":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.haplotypes.hg38.vcf # h1 alleles
# rs7105934[G],rs79373485[C],rs4444099[C],rs117752342[C],rs1122316[G],rs2298764[T],rs117222887[G],rs76809977[C],rs559664[G],rs657315[C],rs498931[A],rs71465432[C],rs183782062[G],rs79442425[C],rs111929748[G],rs117490805[G],rs79241527[C],rs72932500[A],rs57162717[A]

# echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h1 (full-length), no alleles
# rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs2298764,rs117222887,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717

# reduction
# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1 # h1
#  reduced = rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0

# awk 'BEGIN{n=split("rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?",":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.haplotypes.hg38.vcf # h1.reduced alleles
# rs7105934[G],rs79373485[C],rs4444099[C],rs117752342[C],rs1122316[G],rs76809977[C],rs559664[G],rs657315[C],rs498931[A],rs71465432[C],rs183782062[G],rs79442425[C],rs111929748[G],rs117490805[G],rs79241527[C],rs72932500[A],rs57162717[A]

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" h1 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts
# LRT p value = 1.542142e-21 on 1 degree(s) of freedom with HR = 1.255279e+00 (1.199565e+00 to 1.313580e+00), frequency = 9.579968e-02 (34686) = 1.165242e-01/9.471408e-02 (2100/32586)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts
# LRT p value = 1.542142e-21 on 1 degree(s) of freedom with HR = 1.255279e+00 (1.199565e+00 to 1.313580e+00), frequency = 9.579968e-02 (34686) = 1.165242e-01/9.471408e-02 (2100/32586)

# coef  exp(coef)   se(coef)      z Pr(>|z|)
# pc01 -0.0010576  0.9989429  0.0069119 -0.153   0.8784
# pc02 -0.0143600  0.9857426  0.0071569 -2.006   0.0448 *
# pc03  0.0071470  1.0071726  0.0069020  1.035   0.3004
# pc04  0.0034955  1.0035016  0.0051779  0.675   0.4996
# pc05 -0.0005127  0.9994874  0.0022688 -0.226   0.8212
# pc06  0.0069984  1.0070229  0.0065737  1.065   0.2871
# pc07  0.0054773  1.0054923  0.0059056  0.927   0.3537
# pc08 -0.0010440  0.9989565  0.0058793 -0.178   0.8591
# pc09 -0.0024596  0.9975434  0.0022828 -1.077   0.2813
# pc10  0.0057667  1.0057833  0.0050946  1.132   0.2577
#
# exp(coef) exp(-coef) lower .95 upper .95
# pc01    0.9989     1.0011    0.9855    1.0126
# pc02    0.9857     1.0145    0.9720    0.9997
# pc03    1.0072     0.9929    0.9936    1.0209
# pc04    1.0035     0.9965    0.9934    1.0137
# pc05    0.9995     1.0005    0.9951    1.0039
# pc06    1.0070     0.9930    0.9941    1.0201
# pc07    1.0055     0.9945    0.9939    1.0172
# pc08    0.9990     1.0010    0.9875    1.0105
# pc09    0.9975     1.0025    0.9931    1.0020
# pc10    1.0058     0.9942    0.9958    1.0159

# sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh /scratch_space/wletsou/sjlife/GWAS/1000gp_chr11.3/haplotype_estimates.eur.chr11.68850000-69500000.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "rs657686_G=1" /scratch_space/wletsou/sjlife/GWAS/1000gp_chr11.3

# convert .vcf to .bed at SNPs in h1 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.haplotypes.hg38.vcf "rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts

# LD with GWAS hit
# mkdir ukbb_imputed_snps
# cp ukbb_genotyped_snps/ukbb_bca_cases.indiv ukbb_imputed_snps/ukbb_bca_cases.indiv
# cp ukbb_genotyped_snps/ukbb_bca_controls.indiv ukbb_imputed_snps/ukbb_bca_controls.indiv
# cd ukbb_imputed_snps

# vcf file for UKBB
# bsub -P SJLIFE -J ukbb_topmed_merge.chr11.69231642-69431642 -oo ukbb_topmed_merge.chr11.69231642-69431642.out -eo ukbb_topmed_merge.chr11.69231642-69431642.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_topmed_merge.sh \"\" /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 69231642,69431642 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps /home/wletsou/scripts"

# extract imputed SNPs in range
# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.69231642-69431642 -oo ukbb_haplotype_extract3.chr11.69231642-69431642.out -eo ukbb_haplotype_extract3.chr11.69231642-69431642.err -R "rusage[mem=10000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv \"rs10160464,rs4980785,rs7105934,rs6606643,rs7927237,rs79373485,rs61881566,rs117796657,rs74512832,rs7394746,rs7113550,rs10501399,rs4444099,rs11604051,rs57217362,rs10737153,rs57506806,rs117752342,rs76987532,rs587230,rs1122316,rs4980661,rs2298764,rs637185,rs117222887,rs665172,rs592081,rs11601399,rs76809977,rs598828,rs559664,rs657315,rs498931,rs71465432,rs75296154,rs72929545,rs1463618,rs183782062,rs79442425,rs117717143,rs2046494,rs111929748,rs117490805,rs2156513,rs625237,rs638385,rs72932461,rs7108090,rs79241527,rs77997559,rs7122472,rs72932500,rs75277033,rs74412847,rs113417932,rs77772082,rs57162717,rs66516223,rs554219\" /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 69231642,69431642 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.69231642-69431642.imputed.hg38.vcf.gz /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_haplotype_LD2 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps/ukbb_haplotype_haplotype_LD2.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps/ukbb_haplotype_haplotype_LD2.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" \"rs554219_G=1\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps" # h1 (reduced) vs GWAS hit
# 0.0957997	0.119444	0.0956505
# rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0	rs554219_G=1	0.778311	0.998232

# effect of GWAS hit
# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt "rs554219_G=1" "" "" "" "" rs554219 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_imputed_snps /home/wletsou/scripts
# LRT p value = 3.009969e-22 on 1 degree(s) of freedom with HR = 1.235763e+00 (1.185297e+00 to 1.288379e+00), frequency = 1.194444e-01 (43247) = 1.424925e-01/1.182371e-01 (2568/40679)

# liftover SNPs GRCh38 to 37
# cat ukbb_snp_list.chr11.69231642-69431642.txt | tr '\n' ','
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.69231642-69431642.haplotypes.hg38.vcf "rs10160464,rs4980785,rs7105934,rs6606643,rs7927237,rs79373485,rs61881566,rs117796657,rs74512832,rs7394746,rs7113550,rs10501399,rs4444099,rs11604051,rs57217362,rs10737153,rs57506806,rs117752342,rs76987532,rs587230,rs1122316,rs4980661,rs2298764,rs637185,rs117222887,rs665172,rs592081,rs11601399,rs76809977,rs598828,rs559664,rs657315,rs498931,rs71465432,rs75296154,rs72929545,rs1463618,rs183782062,rs79442425,rs117717143,rs2046494,rs111929748,rs117490805,rs2156513,rs625237,rs638385,rs72932461,rs7108090,rs79241527,rs77997559,rs7122472,rs72932500,rs75277033,rs74412847,rs113417932,rs77772082,rs57162717,rs66516223" "" region.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34 /home/wletsou/scripts

# mkdir phase2
# cp ukbb_bca_cases.indiv phase2/ukbb_bca_cases.indiv
# cp ukbb_bca_controls.indiv phase2/ukbb_bca_controls.indiv
# cp dbgap28544_cases.indiv phase2/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv phase2/dbgap28544_controls.indiv
# cd phase2

# get h1 and list of SNPs in upstream region
# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.chr11.68850000-69231641.txt

# check that SNPs have good "imputation" quality
# awk 'NR==FNR{snp[$1]; next} ($8 in snp && $15==1){print $8}' CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info > CCND1_TAD_snps.chr11.68850000-69231641.tmp
# test -f CCND1_TAD_snps.chr11.68850000-69231641.tmp && mv CCND1_TAD_snps.chr11.68850000-69231641.tmp CCND1_TAD_snps.chr11.68850000-69231641.txt

# vcf files of region (UKBB and dbGaP)
# bsub -P SJLIFE -J ukbb_topmed_merge.chr11.68850000-69231641 -oo ukbb_topmed_merge.chr11.68850000-69231641.out -eo ukbb_topmed_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_topmed_merge.sh CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11"

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# first round of overlaps (of h1-carrying chromosomes among cases)
# bsub -P SJLIFE -J ukbb_bca_overlap.chr11.68850000-69231641 -oo ukbb_bca_overlap.chr11.68850000-69231641.out -eo ukbb_bca_overlap.chr11.68850000-69231641.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_submission13.sh ukbb_bca_cases,ukbb_bca_controls,dbgap28544_cases,dbgap28544_controls 11 68850000,69231641 "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 0.0001 \"\" \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts"

# set a threshold for remaining overlaps
# mv Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# awk 'BEGIN{OFS="\t"} NR==FNR{count[$2]=$1; next} ($1 in count){print count[$1],$1}' Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt <(awk '($5+0<1e-4){print $0}' Pattern_differences.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.p_vals.txt | awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=n; seen[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=$1} } END{for (i in seen) {print seen[i]} }') > Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# Begin iterations:
# bsub -P SJLIFE -J pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/pattern_overlap_iterate3.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.subset.txt 11 68850000,69231641 100 50 2 2,j \"\" \"ukbb_bca_cases\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts"

# sh /home/wletsou/scripts/ukbb_pattern_count_summary.sh ukbb_bca_cases 11 68850000,69231641 2,j

# awk '{printf "%s & $%s$ & $%s$ \\\\\n",$1+0,$2,$4}' Pattern_counts.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt # latex table

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# forward selection
# translated in parallel, p <
# test -f fisher_exact.ukbb_bca_cases.Results.txt && rm fisher_exact.ukbb_bca_cases.Results.txt; touch fisher_exact.ukbb_bca_cases.Results.txt; for file in fisher_exact.ukbb_bca_cases.Iteration*.txt; do awk '($6+0<1e-2){print $0}' $file >> fisher_exact.ukbb_bca_cases.Results.txt; done;

# remove longer patterns with the same frequency, OR, and p-value as a shorter pattern
# awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=n; seen[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=$0} }  END{for (i in seen) {print seen[i]} }' fisher_exact.ukbb_bca_cases.Results.txt > fisher_exact.ukbb_bca_cases.Results.tmp; test -f fisher_exact.ukbb_bca_cases.Results.tmp && mv fisher_exact.ukbb_bca_cases.Results.tmp fisher_exact.ukbb_bca_cases.Results.txt

# bsub -P SJLIFE -J ukbb_haplotype_translate2_sub -oo ukbb_haplotype_translate2_sub.out -eo ukbb_haplotype_translate2_sub.err -R "rusage[mem=256]" -q standard "sh /home/wletsou/scripts/ukbb_haplotype_translate2_sub.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt fisher_exact.ukbb_bca_cases.Results.txt 50"

# bsub -P SJLIFE -J ukbb_haplotype_model9_sub -oo ukbb_haplotype_model9_sub.out -eo ukbb_haplotype_model9_sub.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt fisher_exact.ukbb_bca_cases.Results.translated.txt 1 \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" 1 11 68850000,69231641 50 \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_model9_iterate -oo ukbb_haplotype_model9_iterate.out -eo ukbb_haplotype_model9_iterate.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_iterate.sh allele_counts.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt 1 1 0.01 Significant_patterns.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts"

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<0.005 && $3 > 1){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs12274095_A=0,rs73512137_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs117131950_A=0,rs142581206_T=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" h2-h8 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=h2-h8.new_allele_counts.txt n=7 groups=1,2,3,4,5,6,7,8 threshold=0.05 n_covs=10

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<1e-5){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" h2-h4 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h2-h4.new_allele_counts.txt groups=1,2,3,4 verbose=1 n=3 n_covs=10
# [1] "X0000" "X1000" "X1001" "X1010" "X1100"
# [1] "DT[,h0:=X0000]"
# [1] "DT[,h1.4:=X1000+X1001]"
# [1] "DT[,h1:=X1000]"
# [1] "DT[,h2:=X1100]"
# [1] "DT[,h3:=X1010]"
# [1] "DT[,h4:=X1001]"
#
#    affected  h1.4    h1  h2 h3 h4
# 1:        0 32421 32416 116 49  5
# 2:        1  2057  2051  26 17  6
#
#    affected       h1.4         h1           h2           h3           h4
# 1:        0 0.09423449 0.09421996 0.0003371642 0.0001424228 1.453294e-05
# 2:        1 0.11413828 0.11380535 0.0014426812 0.0009432915 3.329264e-04
#
#     h1.4    h1  h2 h3 h4
# 1: 34478 34467 142 66 11
#
#          h1.4         h1           h2           h3           h4
# 1: 0.09522521 0.09519483 0.0003921915 0.0001822862 3.038103e-05
#
# Surv(age,affected) ~ h1 + h2 + h3 + h4 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2076314  1.2307595  0.0234194  8.866  < 2e-16 ***
# h2    1.4389142  4.2161156  0.1964161  7.326 2.37e-13 ***
# h3    1.7700066  5.8708918  0.2428332  7.289 3.12e-13 ***
# h4    2.8208394 16.7909390  0.4084818  6.906 5.00e-12 ***
# pc01 -0.0010510  0.9989495  0.0069137 -0.152   0.8792
# pc02 -0.0145911  0.9855149  0.0071579 -2.038   0.0415 *
# pc03  0.0075323  1.0075608  0.0069019  1.091   0.2751
# pc04  0.0035903  1.0035968  0.0051799  0.693   0.4882
# pc05 -0.0006071  0.9993931  0.0022693 -0.268   0.7891
# pc06  0.0068624  1.0068860  0.0065714  1.044   0.2964
# pc07  0.0052451  1.0052589  0.0059047  0.888   0.3744
# pc08 -0.0013264  0.9986745  0.0058789 -0.226   0.8215
# pc09 -0.0026400  0.9973635  0.0022836 -1.156   0.2476
# pc10  0.0055542  1.0055696  0.0050958  1.090   0.2757
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2308    0.81251    1.1755    1.2886
# h2      4.2161    0.23719    2.8689    6.1959
# h3      5.8709    0.17033    3.6476    9.4494
# h4     16.7909    0.05956    7.5401   37.3917
# pc01    0.9989    1.00105    0.9855    1.0126
# pc02    0.9855    1.01470    0.9718    0.9994
# pc03    1.0076    0.99250    0.9940    1.0213
# pc04    1.0036    0.99642    0.9935    1.0138
# pc05    0.9994    1.00061    0.9950    1.0038
# pc06    1.0069    0.99316    0.9940    1.0199
# pc07    1.0053    0.99477    0.9937    1.0170
# pc08    0.9987    1.00133    0.9872    1.0102
# pc09    0.9974    1.00264    0.9929    1.0018
# pc10    1.0056    0.99446    0.9956    1.0157
#
# Concordance= 0.527  (se = 0.003 )
# Likelihood ratio test= 176.2  on 14 df,   p=<2e-16
# Wald test            = 244.8  on 14 df,   p=<2e-16
# Score (logrank) test = 313.2  on 14 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=h2-h4.new_allele_counts.txt n=3 groups=1,2,3,4 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.030050e-07
# 2:             h3 3.186593e-07
# 3:             h4 6.938959e-06

# reduction
# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h2
#  reduced = rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1

# awk 'BEGIN{n=split("rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?",":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h2.reduced alleles
# rs74674490[A],rs72930631[T],rs11228502[T],rs10896431[C],rs17149775[A],rs117236867[A],rs11228530[A],rs78033785[C],rs117694794[C],rs75590802[G],rs7937094[C],rs7931342[T],rs116951063[C],rs11825015[C],rs78656034[C],rs7103126[C],rs12274095[C],rs12789955[T],rs72932198[G],rs61882193[A],rs12790064[G]

# awk 'BEGIN{n=split("rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?", ":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h2.full-length alleles
# rs2376558[C], rs149949063[A], rs144905179[G], rs74674490[A], rs72930627[C], rs72930631[T], rs11228502[T], rs12577213[C], rs73520512[C], rs10896431[C], rs74897859[C], rs55703863[G], rs17149775[A], rs117236867[A], rs11228530[A], rs17309046[T], rs56134379[G], rs72932540[A], rs78033785[C], rs74342245[G], rs35435383[G], rs117694794[C], rs10792029[G], rs78208050[A], rs61881109[G], rs75590802[G], rs7937094[C], rs7931342[T], rs10896449[A], rs7130881[A], rs7119988[G], rs111762835[G], rs4930672[G], rs11228599[G], rs7940107[G], rs72930267[A], rs7946255[T], rs116951063[C], rs118004919[G], rs35637432[G], rs34737133[C], rs11825015[C], rs78656034[C], rs117821797[C], rs56103266[G], rs117131950[G], rs7103126[C], rs116926312[C], rs12274095[C], rs10896461[G], rs78919175[C], rs7124547[T], rs12789955[T], rs115223540[C], rs28378931[A], rs117186144[C], rs72932198[G], rs12802601[T], rs12796465[A], rs61882193[A], rs12790064[G], rs11263638[G], rs74471298[G]

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h3
#  reduced = rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0

# awk 'BEGIN{n=split("rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?",":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h3.reduced alleles
# rs74674490[A],rs74897859[C],rs67039008[A],rs17149775[G],rs11228530[A],rs12418948[C],rs61881109[G],rs10896449[G],rs7130881[A],rs7103126[T],rs11603814[C],rs12789955[T],rs79487139[C],rs11600497[C],rs12790064[G],rs76855139[C]

# awk 'BEGIN{n=split("rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?", ":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h3.full-length alleles
# rs2376558[C], rs61881030[C], rs149949063[A], rs144905179[G], rs74674490[A], rs12577213[C], rs73520512[C], rs3892895[G], rs7116054[C], rs74897859[C], rs17308715[C], rs67039008[A], rs17149775[G], rs117236867[A], rs11228530[A], rs17309046[T], rs56134379[G], rs72932540[A], rs12418948[C], rs78033785[C], rs74342245[G], rs35435383[G], rs117694794[C], rs10792029[G], rs78208050[A], rs61881109[G], rs75590802[G], rs7937094[C], rs7931342[G], rs10896449[G], rs7130881[A], rs111762835[G], rs4930672[G], rs116951063[C], rs118004919[G], rs35637432[G], rs34737133[C], rs78656034[C], rs74551015[G], rs117821797[C], rs12275849[T], rs117131950[G], rs7103126[T], rs11539762[G], rs142581206[G], rs11228610[G], rs12274095[C], rs73512137[C], rs12224376[G], rs11603814[C], rs72932105[C], rs12789955[T], rs117186144[C], rs79487139[C], rs11600497[C], rs72932198[G], rs12802601[T], rs12790064[G], rs76855139[C], rs74471298[G]

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h4
#  reduced = rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0

# awk 'BEGIN{n=split("rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?",":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h4.reduced alleles
# rs74674490[A],rs3892895[G],rs74897859[C],rs67039008[A],rs55703863[G],rs11228565[G],rs116951063[C],rs11825015[C],rs74551015[G],rs11539762[G],rs7124547[T],rs11603814[G],rs79487139[C],rs4275647[C],rs11263641[T],rs76855139[C]

# awk 'BEGIN{n=split("rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0",array,","); for (i=1;i<=n;i++) {a=gensub("(.*)_[A-Z]=(.*)","\\1","g",array[i]); b=gensub("(.*)=(.*)","\\2","g",array[i]); haplotype_snps[a]=b} } ($3 in haplotype_snps){found+=1; printf "%s[%s]%s",$3,(haplotype_snps[$3]==1?$5:$4),(found<n?", ":"\n")}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf # h4.full-length alleles
# rs2376558[C], rs61881030[C], rs149949063[A], rs144905179[G], rs74674490[A], rs12577213[C], rs73520512[C], rs3892895[G], rs7116054[C], rs74897859[C], rs17308715[C], rs67039008[A], rs55703863[G], rs117236867[A], rs11228530[A], rs17309046[T], rs56134379[G], rs78033785[C], rs74342245[G], rs35435383[G], rs117694794[C], rs10792029[G], rs78208050[A], rs61881109[G], rs75590802[G], rs11228565[G], rs7937094[C], rs7130881[A], rs7119988[G], rs111762835[G], rs4930672[G], rs11228599[G], rs7940107[G], rs72930267[A], rs7946255[T], rs116951063[C], rs118004919[G], rs35637432[G], rs34737133[C], rs11825015[C], rs78656034[C], rs74551015[G], rs117821797[C], rs12275849[T], rs56103266[G], rs117131950[G], rs116926312[C], rs11539762[G], rs142581206[G], rs11228610[G], rs12274095[C], rs12224376[G], rs7124547[T], rs11603814[G], rs115223540[C], rs28378931[A], rs117186144[C], rs79487139[C], rs11600497[C], rs72932198[G], rs12802601[T], rs12796465[A], rs4275647[C], rs61882193[A], rs12790064[G], rs11263638[G], rs11263641[T], rs76855139[C], rs74471298[G]

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h5
#  reduced = rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h6
#  reduced = rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs12274095_A=0,rs73512137_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h7
#  reduced = rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs117131950_A=0,rs142581206_T=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # h8
#  reduced = rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs61881109_A=0,rs10896449_G=1,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs117821797_T=0,rs117131950_A=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0

# reduced-haplotypes model
# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1:rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0:rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0:rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0:rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0:rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs61881109_A=0,rs10896449_G=1,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs117821797_T=0,rs117131950_A=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" h2-h8.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=h2-h8.reduced.new_allele_counts.txt n=7 groups=1,2,3,4,5,6,7,8 threshold=0.05 n_covs=10

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1:rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0:rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" h2-h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h2-h4.reduced.new_allele_counts.txt groups=1,2,3,4 verbose=1 n=3 n_covs=10
# [1] "X0000" "X1000" "X1001" "X1010" "X1100"
# [1] "DT[,h0:=X0000]"
# [1] "DT[,h1.4:=X1000+X1001]"
# [1] "DT[,h1:=X1000]"
# [1] "DT[,h2:=X1100]"
# [1] "DT[,h3:=X1010]"
# [1] "DT[,h4:=X1001]"
#
#    affected  h1.4    h1  h2 h3 h4
# 1:        0 32421 32416 116 49  5
# 2:        1  2057  2051  26 17  6
#
#    affected       h1.4         h1           h2           h3           h4
# 1:        0 0.09423449 0.09421996 0.0003371642 0.0001424228 1.453294e-05
# 2:        1 0.11413828 0.11380535 0.0014426812 0.0009432915 3.329264e-04
#
#     h1.4    h1  h2 h3 h4
# 1: 34478 34467 142 66 11
#
#          h1.4         h1           h2           h3           h4
# 1: 0.09522521 0.09519483 0.0003921915 0.0001822862 3.038103e-05
#
# Surv(age,affected) ~ h1 + h2 + h3 + h4 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2076314  1.2307595  0.0234194  8.866  < 2e-16 ***
# h2    1.4389142  4.2161156  0.1964161  7.326 2.37e-13 ***
# h3    1.7700066  5.8708918  0.2428332  7.289 3.12e-13 ***
# h4    2.8208394 16.7909390  0.4084818  6.906 5.00e-12 ***
# pc01 -0.0010510  0.9989495  0.0069137 -0.152   0.8792
# pc02 -0.0145911  0.9855149  0.0071579 -2.038   0.0415 *
# pc03  0.0075323  1.0075608  0.0069019  1.091   0.2751
# pc04  0.0035903  1.0035968  0.0051799  0.693   0.4882
# pc05 -0.0006071  0.9993931  0.0022693 -0.268   0.7891
# pc06  0.0068624  1.0068860  0.0065714  1.044   0.2964
# pc07  0.0052451  1.0052589  0.0059047  0.888   0.3744
# pc08 -0.0013264  0.9986745  0.0058789 -0.226   0.8215
# pc09 -0.0026400  0.9973635  0.0022836 -1.156   0.2476
# pc10  0.0055542  1.0055696  0.0050958  1.090   0.2757
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2308    0.81251    1.1755    1.2886
# h2      4.2161    0.23719    2.8689    6.1959
# h3      5.8709    0.17033    3.6476    9.4494
# h4     16.7909    0.05956    7.5401   37.3917
# pc01    0.9989    1.00105    0.9855    1.0126
# pc02    0.9855    1.01470    0.9718    0.9994
# pc03    1.0076    0.99250    0.9940    1.0213
# pc04    1.0036    0.99642    0.9935    1.0138
# pc05    0.9994    1.00061    0.9950    1.0038
# pc06    1.0069    0.99316    0.9940    1.0199
# pc07    1.0053    0.99477    0.9937    1.0170
# pc08    0.9987    1.00133    0.9872    1.0102
# pc09    0.9974    1.00264    0.9929    1.0018
# pc10    1.0056    0.99446    0.9956    1.0157
#
# Concordance= 0.527  (se = 0.003 )
# Likelihood ratio test= 176.2  on 14 df,   p=<2e-16
# Wald test            = 244.8  on 14 df,   p=<2e-16
# Score (logrank) test = 313.2  on 14 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=h2-h4.reduced.new_allele_counts.txt n=3 groups=1,2,3,4 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.030050e-07
# 2:             h3 3.186593e-07
# 3:             h4 6.938959e-06

# plot SNPs

# echo "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h2, no alleles
# convert .vcf to .bed at SNPs in h2 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs74674490,rs72930631,rs11228502,rs10896431,rs17149775,rs117236867,rs11228530,rs78033785,rs117694794,rs75590802,rs7937094,rs7931342,rs116951063,rs11825015,rs78656034,rs7103126,rs12274095,rs12789955,rs72932198,rs61882193,rs12790064,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" h2.reduced.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts

# sh /home/wletsou/scripts/vcf2bed2.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "h2.full-length.bed" # h2 full-length, with alleles

# awk 'NR>1 && 69516874<$2 && found==0{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n","chr11",69516874-1,69516874,"rs554219",0,".",69516874-1,69516874,"0,0,0"; found++} NR==1 || 69516874>=$2 || found>0{print $0}' h2.full-length.bed > h2.full-length.rs554219.bed # add GWAS hit in black

# echo "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h3, no alleles
# convert .vcf to .bed at SNPs in h3 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs74674490,rs74897859,rs67039008,rs17149775,rs11228530,rs12418948,rs61881109,rs10896449,rs7130881,rs7103126,rs11603814,rs12789955,rs79487139,rs11600497,rs12790064,rs76855139,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" h3.reduced.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts

# echo "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h4, no alleles
# convert .vcf to .bed at SNPs in h4 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs74674490,rs3892895,rs74897859,rs67039008,rs55703863,rs11228565,rs116951063,rs11825015,rs74551015,rs11539762,rs7124547,rs11603814,rs79487139,rs4275647,rs11263641,rs76855139,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" h4.reduced.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts

# sh /home/wletsou/scripts/vcf2bed2.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "h4.full-length.bed" # h4 full-length, with alleles

# awk 'NR>1 && 69516874<$2 && found==0{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n","chr11",69516874-1,69516874,"rs554219",0,".",69516874-1,69516874,"0,0,0"; found++} NR==1 || 69516874>=$2 || found>0{print $0}' h4.full-length.bed > h4.full-length.rs554219.bed # add GWAS hit in black

# haplotype blocks

# convert to ped and map format
# module load plink/1.90b

# h2 snps, no alleles, full-length, h1 included

# echo "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g'
# rs2376558,rs149949063,rs144905179,rs74674490,rs72930627,rs72930631,rs11228502,rs12577213,rs73520512,rs10896431,rs74897859,rs55703863,rs17149775,rs117236867,rs11228530,rs17309046,rs56134379,rs72932540,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs7937094,rs7931342,rs10896449,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs117821797,rs56103266,rs117131950,rs7103126,rs116926312,rs12274095,rs10896461,rs78919175,rs7124547,rs12789955,rs115223540,rs28378931,rs117186144,rs72932198,rs12802601,rs12796465,rs61882193,rs12790064,rs11263638,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717

# echo "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' | sed -E 's/([^,]*)/"\1"/g'

# get h2 variants names in vcf.gz file
# awk 'BEGIN{n=split("rs2376558,rs149949063,rs144905179,rs74674490,rs72930627,rs72930631,rs11228502,rs12577213,rs73520512,rs10896431,rs74897859,rs55703863,rs17149775,rs117236867,rs11228530,rs17309046,rs56134379,rs72932540,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs7937094,rs7931342,rs10896449,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs117821797,rs56103266,rs117131950,rs7103126,rs116926312,rs12274095,rs10896461,rs78919175,rs7124547,rs12789955,rs115223540,rs28378931,rs117186144,rs72932198,rs12802601,rs12796465,rs61882193,rs12790064,rs11263638,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717",array,","); for (i=1;i<=n;i++) {rsid[array[i]]} } ($3 in rsid){found+=1; printf "%s:%s:%s:%s\n",$1,$2,$4,$5}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf > h2_snps.txt

# ped and map files of UKBB subjects at h2 SNPs
# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --recode --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h2 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h2_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --r2 --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h2 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h2_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --blocks no-pheno-req --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h2 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h2_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --freq --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h2 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h2_snps.txt

# h4 snps, no alleles, full-length, h1 included

# echo "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g'
# rs2376558,rs61881030,rs149949063,rs144905179,rs74674490,rs12577213,rs73520512,rs3892895,rs7116054,rs74897859,rs17308715,rs67039008,rs55703863,rs117236867,rs11228530,rs17309046,rs56134379,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs11228565,rs7937094,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs74551015,rs117821797,rs12275849,rs56103266,rs117131950,rs116926312,rs11539762,rs142581206,rs11228610,rs12274095,rs12224376,rs7124547,rs11603814,rs115223540,rs28378931,rs117186144,rs79487139,rs11600497,rs72932198,rs12802601,rs12796465,rs4275647,rs61882193,rs12790064,rs11263638,rs11263641,rs76855139,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717

# get h4 variants names in vcf.gz file
# awk 'BEGIN{n=split("rs2376558,rs61881030,rs149949063,rs144905179,rs74674490,rs12577213,rs73520512,rs3892895,rs7116054,rs74897859,rs17308715,rs67039008,rs55703863,rs117236867,rs11228530,rs17309046,rs56134379,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs11228565,rs7937094,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs74551015,rs117821797,rs12275849,rs56103266,rs117131950,rs116926312,rs11539762,rs142581206,rs11228610,rs12274095,rs12224376,rs7124547,rs11603814,rs115223540,rs28378931,rs117186144,rs79487139,rs11600497,rs72932198,rs12802601,rs12796465,rs4275647,rs61882193,rs12790064,rs11263638,rs11263641,rs76855139,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717",array,","); for (i=1;i<=n;i++) {rsid[array[i]]} } ($3 in rsid){found+=1; printf "%s:%s:%s:%s\n",$1,$2,$4,$5}' ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf > h4_snps.txt

# ped and map files of UKBB subjects at h2 SNPs
# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --recode --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h4 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h4_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --r2 --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h4 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h4_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --blocks no-pheno-req --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h4 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h4_snps.txt

# plink --vcf ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz --freq --out ukbb_bca_cases+ukbb_bca_controls.hg19_chr11.68850000-69231641.hg38.h4 --keep ukbb_bca_cases+ukbb_bca_controls.indiv --extract h4_snps.txt

# 1000GP LD blocks

# mkdir LD_blocks
# cd LD_blocks

# module load bcftools/1.10.2
# module load plink/1.90b

# get all UKBB SNPs in TAD
# awk 'BEGIN{OFS="\t"} ($2>=68850000 && $2<=69500000){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.chr11.68850000-69500000.txt

# eur indiv file
# awk 'BEGIN{OFS="\t"} {print $1,$1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/EUR.txt > eur.indiv

# eur samples file
# awk 'BEGIN{OFS="\t"} {print $1}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/EUR.txt > eur.samples

# CRCh38 region string at UKBB-genotyped SNPs
# awk 'NR==FNR{seen[$1]; next} ($1 in seen){printf "%s%s:%s",(found>0?",":""),$2,$3; found++}' CCND1_TAD_snps.chr11.68850000-69500000.txt <(bcftools query -r 11:69000000-70000000 -f '%ID\t%CHROM\t%POS\t%REF\t%ALT\n' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/GRCh38/ALL.chr11_GRCh38.genotypes.20170504.vcf.gz)
# 11:69083946,11:69083998,11:69085616,11:69085685,11:69085729,11:69087729,11:69087895,11:69092678,11:69099653,11:69100367,11:69110120,11:69114683,11:69114776,11:69117287,11:69119549,11:69124227,11:69126381,11:69127338,11:69130541,11:69133728,11:69142111,11:69145367,11:69151517,11:69151962,11:69153340,11:69154575,11:69159054,11:69168018,11:69171308,11:69180342,11:69191192,11:69195706,11:69199415,11:69200174,11:69201946,11:69209346,11:69210118,11:69211113,11:69212239,11:69227030,11:69227200,11:69228491,11:69248404,11:69250616,11:69251764,11:69258819,11:69260303,11:69263523,11:69263730,11:69265264,11:69267799,11:69269130,11:69275141,11:69277004,11:69285720,11:69286582,11:69287175,11:69287948,11:69289127,11:69295686,11:69295926,11:69296009,11:69296043,11:69296259,11:69296261,11:69296300,11:69296517,11:69302071,11:69306180,11:69306623,11:69309047,11:69309919,11:69311104,11:69311184,11:69311667,11:69317083,11:69321285,11:69321751,11:69328516,11:69338687,11:69352233,11:69358550,11:69360358,11:69361135,11:69367952,11:69371038,11:69377704,11:69382816,11:69386345,11:69392822,11:69409182,11:69414699,11:69419318,11:69419726,11:69424973,11:69427039,11:69431044,11:69432853,11:69440357,11:69441137,11:69445812,11:69447660,11:69455000,11:69455090,11:69458108,11:69461097,11:69463122,11:69467061,11:69468656,11:69475035,11:69481119,11:69485003,11:69485307,11:69491811,11:69493156,11:69493255,11:69494966,11:69497221,11:69499499,11:69505694,11:69508496,11:69512840,11:69517492,11:69517944,11:69524849,11:69528387,11:69529047,11:69534620,11:69536953,11:69539114,11:69562741,11:69563926,11:69564065,11:69564519,11:69572513,11:69577504,11:69577536,11:69578184,11:69578903,11:69579623,11:69581315,11:69589495,11:69600013,11:69603668,11:69604545,11:69606421,11:69607996,11:69608555,11:69609602,11:69616860,11:69620462,11:69628784,11:69629054,11:69631784,11:69631951,11:69633807,11:69637791,11:69638738,11:69640683,11:69646918,11:69648142,11:69650025,11:69652194,11:69653818,11:69654008,11:69654655,11:69657469,11:69657605,11:69657694,11:69660249,11:69663416,11:69665423,11:69667300,11:69667456,11:69673422,11:69675160,11:69675233,11:6967553

# SNPs not included
# awk 'NR==FNR{seen[$1]; next} ($1 in seen==0){print $0}' <(bcftools query -r 11:69000000-70000000 -f '%ID\t%CHROM\t%POS\t%REF\t%ALT\n' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/GRCh38/ALL.chr11_GRCh38.genotypes.20170504.vcf.gz) CCND1_TAD_snps.chr11.68850000-69500000.txt
# Affx-5785962

# bcftools view -r "11:69083946,11:69083998,11:69085616,11:69085685,11:69085729,11:69087729,11:69087895,11:69092678,11:69099653,11:69100367,11:69110120,11:69114683,11:69114776,11:69117287,11:69119549,11:69124227,11:69126381,11:69127338,11:69130541,11:69133728,11:69142111,11:69145367,11:69151517,11:69151962,11:69153340,11:69154575,11:69159054,11:69168018,11:69171308,11:69180342,11:69191192,11:69195706,11:69199415,11:69200174,11:69201946,11:69209346,11:69210118,11:69211113,11:69212239,11:69227030,11:69227200,11:69228491,11:69248404,11:69250616,11:69251764,11:69258819,11:69260303,11:69263523,11:69263730,11:69265264,11:69267799,11:69269130,11:69275141,11:69277004,11:69285720,11:69286582,11:69287175,11:69287948,11:69289127,11:69295686,11:69295926,11:69296009,11:69296043,11:69296259,11:69296261,11:69296300,11:69296517,11:69302071,11:69306180,11:69306623,11:69309047,11:69309919,11:69311104,11:69311184,11:69311667,11:69317083,11:69321285,11:69321751,11:69328516,11:69338687,11:69352233,11:69358550,11:69360358,11:69361135,11:69367952,11:69371038,11:69377704,11:69382816,11:69386345,11:69392822,11:69409182,11:69414699,11:69419318,11:69419726,11:69424973,11:69427039,11:69431044,11:69432853,11:69440357,11:69441137,11:69445812,11:69447660,11:69455000,11:69455090,11:69458108,11:69461097,11:69463122,11:69467061,11:69468656,11:69475035,11:69481119,11:69485003,11:69485307,11:69491811,11:69493156,11:69493255,11:69494966,11:69497221,11:69499499,11:69505694,11:69508496,11:69512840,11:69517492,11:69517944,11:69524849,11:69528387,11:69529047,11:69534620,11:69536953,11:69539114,11:69562741,11:69563926,11:69564065,11:69564519,11:69572513,11:69577504,11:69577536,11:69578184,11:69578903,11:69579623,11:69581315,11:69589495,11:69600013,11:69603668,11:69604545,11:69606421,11:69607996,11:69608555,11:69609602,11:69616860,11:69620462,11:69628784,11:69629054,11:69631784,11:69631951,11:69633807,11:69637791,11:69638738,11:69640683,11:69646918,11:69648142,11:69650025,11:69652194,11:69653818,11:69654008,11:69654655,11:69657469,11:69657605,11:69657694,11:69660249,11:69663416,11:69665423,11:69667300,11:69667456,11:69673422,11:69675160,11:69675233,11:6967553" --samples-file eur.samples --force-samples -m2 -M2 -v snps --output-type z -o 1000gp.hg19_11.68850000-69500000.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/GRCh38/ALL.chr11_GRCh38.genotypes.20170504.vcf.gz

# all of TAD
# bcftools view -r "11:69050000-69700000" --samples-file eur.samples --force-samples -m2 -M2 -v snps --output-type z -o 1000gp.11.69050000-69700000.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/1000genomes/GRCh38/ALL.chr11_GRCh38.genotypes.20170504.vcf.gz

# plink --vcf 1000gp.11.69050000-69700000.hg38.vcf.gz --vcf-half-call 'm' --recode --out 1000gp.11.69050000-69700000.hg38

# bsub -P SJLIFE -J ukbb_topmed_merge.chr11.68850000-69500000 -oo ukbb_topmed_merge.chr11.68850000-69500000.out -eo ukbb_topmed_merge.chr11.68850000-69500000.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_topmed_merge.sh \"\" /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 68850000,69500000 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11"

# haplotype segments

# /home/wletsou/scripts/ukbb_LD_block_haplotype.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 ~/Chromosome_Overlap_results/UKBB_chr11.34/phase2/LD_blocks/1000gp.11.69050000-69700000.hg38.res.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf h2.LD_blocks.txt # h2 reduced

# /home/wletsou/scripts/ukbb_LD_block_haplotype.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" ~/Chromosome_Overlap_results/UKBB_chr11.34/phase2/LD_blocks/1000gp.11.69050000-69700000.hg38.res.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf h2.LD_blocks.txt # h2 full-length

# awk 'BEGIN{FS="\t"} {printf "%s & %s & $%s$\\\\\n",$1,$2,$3}' h2.LD_blocks.txt | sed 's/,/, /g' # latex table

# /home/wletsou/scripts/ukbb_LD_block_haplotype.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" ~/Chromosome_Overlap_results/UKBB_chr11.34/phase2/LD_blocks/1000gp.11.69050000-69700000.hg38.res.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf h4.LD_blocks.txt # h4 reduced

# /home/wletsou/scripts/ukbb_LD_block_haplotype.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" ~/Chromosome_Overlap_results/UKBB_chr11.34/phase2/LD_blocks/1000gp.11.69050000-69700000.hg38.res.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf h4.LD_blocks.txt # h4 full-length

# awk 'BEGIN{FS="\t"} {printf "%s & %s & $%s$\\\\\n",$1,$2,$3}' h4.LD_blocks.txt | sed 's/,/, /g' # latex table

# cd ..

# bsub -P SJLIFE -J ukbb_haplotype_haplotype_LD2 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_haplotype_haplotype_LD2.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/ukbb_haplotype_haplotype_LD2.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt \"rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs61881109_A=0,rs10896449_G=1,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs117821797_T=0,rs117131950_A=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2" # h2-h7 (reduced) vs themselves

# dbGaP replication

# mkdir dbgap28544_imputed_snps
# cp dbgap28544_cases.indiv dbgap28544_imputed_snps/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv dbgap28544_imputed_snps/dbgap28544_controls.indiv
# cd dbgap28544_imputed_snps

# extract imputed SNPs in range (h1.full-length plus GWAS hit)
# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.69231642-69431642 -oo ukbb_haplotype_extract3.chr11.69231642-69431642.out -eo ukbb_haplotype_extract3.chr11.69231642-69431642.err -R "rusage[mem=10000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh dbgap28544_cases.indiv,dbgap28544_controls.indiv \"rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs2298764,rs117222887,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717,rs554219\" /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 69231642,69431642  /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps /home/wletsou/scripts"

# effect of GWAS hit

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt "rs554219_G=1" "" "" "" "" rs554219 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps /home/wletsou/scripts
# LRT p value = 7.858252e-27 on 1 degree(s) of freedom with OR = 1.210425e+00 (1.168739e+00 to 1.253598e+00), frequency = 1.367307e-01 (15135) = 1.463877e-01/1.252472e-01 (8802/6333)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt "rs554219_G=1" "" "" "" "" rs554219 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps /home/wletsou/scripts
# LRT p value = 3.167612e-27 on 1 degree(s) of freedom with OR = 1.212619e+00 (1.170789e+00 to 1.255944e+00), frequency = 1.367307e-01 (15135) = 1.463877e-01/1.252472e-01 (8802/6333)

# LD with GWAS hit

# bsub -P SJLIFE -J ukbb_haplotype_haplotype_LD2 -oo ukbb_haplotype_haplotype_LD2.out -eo ukbb_haplotype_haplotype_LD2.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" \"rs554219_G=1\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps" # h1 (reduced) vs GWAS hit
# 0.10587	0.136731	0.105635
# rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0	rs554219_G=1	0.743736	0.99743

# mkdir h1.full-length
# cp ukbb_bca_cases.indiv h1.full-length/ukbb_bca_cases.indiv
# cp ukbb_bca_controls.indiv h1.full-length/ukbb_bca_controls.indiv
# cd h1.full-length

# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt

# bsub -P SJLIFE -J ukbb_topmed_merge.chr11.68850000-69231641 -oo ukbb_topmed_merge.chr11.68850000-69231641.out -eo ukbb_topmed_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_topmed_merge.sh CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11"

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.68850000-69231641 -oo ukbb_haplotype_extract3.chr11.68850000-69231641.out -eo ukbb_haplotype_extract3.chr11.68850000-69231641.err -R "rusage[mem=20000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv,dbgap28544_cases.indiv,dbgap28544_controls.indiv \"CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt\" \"/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info\" 11 68850000,69231641 \"ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts"

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" h2-h4 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/h2-h4.new_allele_counts.txt groups=1,2,3,4 verbose=1 n=3 n_covs=10
# [1] "X0000" "X1000" "X1001" "X1010" "X1100"
# [1] "DT[,h0:=X0000]"
# [1] "DT[,h1.4:=X1000+X1001]"
# [1] "DT[,h1:=X1000]"
# [1] "DT[,h2:=X1100]"
# [1] "DT[,h3:=X1010]"
# [1] "DT[,h4:=X1001]"
#
#    affected  h1.4    h1  h2 h3 h4
# 1:        0 32421 32416 116 49  5
# 2:        1  2057  2051  26 17  6
#
#    affected       h1.4         h1           h2           h3           h4
# 1:        0 0.09423449 0.09421996 0.0003371642 0.0001424228 1.453294e-05
# 2:        1 0.11413828 0.11380535 0.0014426812 0.0009432915 3.329264e-04
#
#     h1.4    h1  h2 h3 h4
# 1: 34478 34467 142 66 11
#
#          h1.4         h1           h2           h3           h4
# 1: 0.09522521 0.09519483 0.0003921915 0.0001822862 3.038103e-05
#
# Surv(age,affected) ~ h1 + h2 + h3 + h4 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2076314  1.2307595  0.0234194  8.866  < 2e-16 ***
# h2    1.4389142  4.2161156  0.1964161  7.326 2.37e-13 ***
# h3    1.7700066  5.8708918  0.2428332  7.289 3.12e-13 ***
# h4    2.8208394 16.7909390  0.4084818  6.906 5.00e-12 ***
# pc01 -0.0010510  0.9989495  0.0069137 -0.152   0.8792
# pc02 -0.0145911  0.9855149  0.0071579 -2.038   0.0415 *
# pc03  0.0075323  1.0075608  0.0069019  1.091   0.2751
# pc04  0.0035903  1.0035968  0.0051799  0.693   0.4882
# pc05 -0.0006071  0.9993931  0.0022693 -0.268   0.7891
# pc06  0.0068624  1.0068860  0.0065714  1.044   0.2964
# pc07  0.0052451  1.0052589  0.0059047  0.888   0.3744
# pc08 -0.0013264  0.9986745  0.0058789 -0.226   0.8215
# pc09 -0.0026400  0.9973635  0.0022836 -1.156   0.2476
# pc10  0.0055542  1.0055696  0.0050958  1.090   0.2757
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2308    0.81251    1.1755    1.2886
# h2      4.2161    0.23719    2.8689    6.1959
# h3      5.8709    0.17033    3.6476    9.4494
# h4     16.7909    0.05956    7.5401   37.3917
# pc01    0.9989    1.00105    0.9855    1.0126
# pc02    0.9855    1.01470    0.9718    0.9994
# pc03    1.0076    0.99250    0.9940    1.0213
# pc04    1.0036    0.99642    0.9935    1.0138
# pc05    0.9994    1.00061    0.9950    1.0038
# pc06    1.0069    0.99316    0.9940    1.0199
# pc07    1.0053    0.99477    0.9937    1.0170
# pc08    0.9987    1.00133    0.9872    1.0102
# pc09    0.9974    1.00264    0.9929    1.0018
# pc10    1.0056    0.99446    0.9956    1.0157
#
# Concordance= 0.527  (se = 0.003 )
# Likelihood ratio test= 176.2  on 14 df,   p=<2e-16
# Wald test            = 244.8  on 14 df,   p=<2e-16
# Score (logrank) test = 313.2  on 14 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=h2-h4.new_allele_counts.txt n=3 groups=1,2,3,4 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.030050e-07
# 2:             h3 3.186593e-07
# 3:             h4 6.938959e-06

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h1 full-length
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h2 full-length
# LRT p value = 2.471105e-02 on 1 degree(s) of freedom with OR = 2.099783e+00 (1.271988e+00 to 3.466298e+00), frequency = 6.685217e-04 (74) = 8.648217e-04/4.350922e-04 (52/22)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h2 reduced
# LRT p value = 2.794544e-02 on 1 degree(s) of freedom with OR = 1.978685e+00 (1.254685e+00 to 3.120461e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h3 full-length
# LRT p value = 6.611334e-01 on 1 degree(s) of freedom with OR = 1.062379e+00 (6.028558e-01 to 1.872169e+00), frequency = 4.426698e-04 (49) = 4.490420e-04/4.350922e-04 (27/22)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h3 reduced
# LRT p value = 6.810697e-01 on 1 degree(s) of freedom with OR = 1.078953e+00 (6.346558e-01 to 1.834285e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h4 full-length
# LRT p value = 2.805067e-03 on 1 degree(s) of freedom with OR = 1.169116e+01 (1.530030e+00 to 8.933363e+01), frequency = 1.264771e-04 (14) = 2.162054e-04/1.977692e-05 (13/1)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts # h4 reduced
# LRT p value = 8.405460e-03 on 1 degree(s) of freedom with OR = 3.956833e+00 (1.484408e+00 to 1.054732e+01), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)

# plot SNPs

# echo "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h2, no alleles
# convert .vcf to .bed at SNPs in h2 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs2376558,rs149949063,rs144905179,rs74674490,rs72930627,rs72930631,rs11228502,rs12577213,rs73520512,rs10896431,rs74897859,rs55703863,rs17149775,rs117236867,rs11228530,rs17309046,rs56134379,rs72932540,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs7937094,rs7931342,rs10896449,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs117821797,rs56103266,rs117131950,rs7103126,rs116926312,rs12274095,rs10896461,rs78919175,rs7124547,rs12789955,rs115223540,rs28378931,rs117186144,rs72932198,rs12802601,rs12796465,rs61882193,rs12790064,rs11263638,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs2298764,rs117222887,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" h2.full-length.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts

# echo "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g' # snps in h4, no alleles
# convert .vcf to .bed at SNPs in h4 (reduced)
# sh /home/wletsou/scripts/vcf2bed.sh ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.haplotypes.hg38.vcf "rs2376558,rs61881030,rs149949063,rs144905179,rs74674490,rs12577213,rs73520512,rs3892895,rs7116054,rs74897859,rs17308715,rs67039008,rs55703863,rs117236867,rs11228530,rs17309046,rs56134379,rs78033785,rs74342245,rs35435383,rs117694794,rs10792029,rs78208050,rs61881109,rs75590802,rs11228565,rs7937094,rs7130881,rs7119988,rs111762835,rs4930672,rs11228599,rs7940107,rs72930267,rs7946255,rs116951063,rs118004919,rs35637432,rs34737133,rs11825015,rs78656034,rs74551015,rs117821797,rs12275849,rs56103266,rs117131950,rs116926312,rs11539762,rs142581206,rs11228610,rs12274095,rs12224376,rs7124547,rs11603814,rs115223540,rs28378931,rs117186144,rs79487139,rs11600497,rs72932198,rs12802601,rs12796465,rs4275647,rs61882193,rs12790064,rs11263638,rs11263641,rs76855139,rs74471298,rs7105934,rs79373485,rs4444099,rs117752342,rs1122316,rs2298764,rs117222887,rs76809977,rs559664,rs657315,rs498931,rs71465432,rs183782062,rs79442425,rs111929748,rs117490805,rs79241527,rs72932500,rs57162717" "" h4.full-length.bed /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length /home/wletsou/scripts

# cd .. # (phase2)

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h1 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h1 reduced
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# factor      OR           ll          ul           p
# [1,] (Intercept)  5.01420e-01 4.45617e-01  5.64211e-01  1.92275e-30
# [2,] age          1.01822e+00 1.01659e+00  1.01985e+00 1.64775e-108
# [3,] pc01        2.05866e+119 6.81361e+83 6.22001e+154  4.36850e-11
# [4,] pc02         2.18318e-05 1.01340e-26  4.70325e+16  6.68495e-01
# [5,] pc03         7.61590e+13 7.88317e+09  7.35768e+17  8.64149e-12
# [6,] pc04         1.35648e-11 2.91987e-14  6.30175e-09  1.38952e-15
# [7,] pc05         1.22085e+17 1.68975e+09  8.82060e+24  2.03198e-05
# [8,] pc06         1.98480e-12 8.24174e-21  4.77987e-04  6.21071e-03
# [9,] pc07         1.94220e-04 2.05684e-06  1.83395e-02  2.30257e-04
# [10,] pc08         4.79507e-05 7.65095e-07  3.00521e-03  2.46879e-06
# [11,] pc09         5.03350e+01 7.20828e-01  3.51486e+03  7.04730e-02
# [12,] pc10         7.94599e-02 1.16522e-03  5.41861e+00  2.39771e-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h1 reduced
# LRT p value = 9.246725e-22 on 1 degree(s) of freedom with OR = 1.209296e+00 (1.163011e+00 to 1.257422e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# factor      OR          ll          ul          p
# [1,] (Intercept) 3.85863e-01 3.49616e-01 4.25869e-01  7.82905e-80
# [2,] age         1.01875e+00 1.01712e+00 1.02038e+00 5.09391e-114
# [3,] pc01        1.79736e+00 3.33503e-02 9.68660e+01  7.73172e-01
# [4,] pc02        3.62370e-06 6.88786e-08 1.90642e-04  5.78882e-10
# [5,] pc03        1.88004e+03 3.26329e+01 1.08312e+05  2.67281e-04
# [6,] pc04        1.32826e+04 2.51733e+02 7.00853e+05  2.70355e-06
# [7,] pc05        3.59289e-03 6.71229e-05 1.92317e-01  5.57490e-03
# [8,] pc06        1.96996e-01 3.67130e-03 1.05705e+01  4.24004e-01
# [9,] pc07        2.16324e+04 4.09425e+02 1.14297e+06  8.15960e-07
# [10,] pc08        1.57809e-03 2.97687e-05 8.36569e-02  1.44916e-03
# [11,] pc09        8.10298e-14 1.45465e-15 4.51368e-12  6.77819e-49
# [12,] pc10        3.96172e-02 7.43839e-04 2.11003e+00  1.11429e-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 2.794544e-02 on 1 degree(s) of freedom with OR = 1.978685e+00 (1.254685e+00 to 3.120461e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 2.636140e-02 on 1 degree(s) of freedom with OR = 1.995407e+00 (1.264663e+00 to 3.148387e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.00 "" 1 # h2 reduced, DRIVE power
# Power to detect OR = 2.00:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 61 -n 60128 -y 27 -m 50564 -o 2.00 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.37609e-06
# OR = 2.000000e+00 (Observed 1.901681e+00, p = 5.123423e-03), power = 8.553933e-01 (8.738000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 60128 -q 5.339767e-04 -m 50564 -o 2.00 -a 0.05 -i
# OR = 2.000000e+00 (Observed 1.901681e+00, p = 5.123423e-03), power = 8.553933e-01 (8.730000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 60128 -q 5.339767e-04 -m 50564 -o 2.00 -a 0.05 -i -c
# OR = 2.000000e+00 (Observed 1.901681e+00, p = 5.123423e-03), power = 8.377562e-01 (8.500000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.00 "" 1 # h2 reduced, UKBB power
# Power to detect OR = 2.00:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 26 -n 18022 -y 116 -m 344046 -o 2.00 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.224961e-07
# OR = 2.000000e+00 (Observed 4.288331e+00, p = 8.810754e-09), power = 6.319490e-01 (5.598000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 18022 -q 5.339767e-04 -m 344046 -o 2.00 -a 1e-5 -i
# OR = 2.000000e+00 (Observed 1.869346e+00, p = 2.135573e-02), power = 6.325676e-02 (5.270000e-02)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 18022 -q 5.339767e-04 -m 344046 -o 2.00 -a 1e-5 -i -c
# OR = 2.000000e+00 (Observed 1.869346e+00, p = 2.135573e-02), power = 5.488230e-02 (4.940000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.00 "" 1 # h2 reduced, combined power
# Power to detect OR = 2.00:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 61 -n 60128 -y 143 -m 394610 -o 2.00 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.993746e-07
# OR = 2.000000e+00 (Observed 2.803171e+00, p = 5.354212e-10), power = 9.794549e-01 (9.502000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 60128 -q 5.339767e-04 -m 394610 -o 2.00 -a 0.05 -i
# OR = 2.000000e+00 (Observed 1.899044e+00, p = 3.163868e-05), power = 9.981151e-01 (9.917000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1.014502e-03 -n 60128 -q 5.339767e-04 -m 394610 -o 2.00 -a 0.05 -i -c
# OR = 2.000000e+00 (Observed 1.899044e+00, p = 3.163868e-05), power = 9.972567e-01 (9.883000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 full-length
# LRT p value = 2.471105e-02 on 1 degree(s) of freedom with OR = 2.099783e+00 (1.271988e+00 to 3.466298e+00), frequency = 6.685217e-04 (74) = 8.648217e-04/4.350922e-04 (52/22)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 full-length
# LRT p value = 2.202367e-02 on 1 degree(s) of freedom with OR = 2.129786e+00 (1.289359e+00 to 3.518016e+00), frequency = 6.685217e-04 (74) = 8.648217e-04/4.350922e-04 (52/22)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h2, DRIVE expected cell counts
# Expected cell counts: a = 40.196871, b = 33.803129, c = 60087.803129, d = 50530.196871

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h2, UKBB expected cell counts
# Expected cell counts: a = 7.068076, b = 134.931924, c = 18014.931924, d = 343911.068076

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.13 "" 1 # h2 full-length, DRIVE power
# Power to detect OR = 2.13:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 52 -n 60128 -y 22 -m 50564 -o 2.13 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 9.83931e-07
# OR = 2.130000e+00 (Observed 1.989328e+00, p = 6.856030e-03), power = 8.510987e-01 (8.745000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 60128 -q 4.350922e-04 -m 50564 -o 2.13 -a 0.05 -i -s 20200116
# OR = 2.130000e+00 (Observed 1.989328e+00, p = 6.856030e-03), power = 8.510987e-01 (8.739000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 60128 -q 4.350922e-04 -m 50564 -o 2.13 -a 0.05 -i -c -s 20200116
# OR = 2.130000e+00 (Observed 1.989328e+00, p = 6.856030e-03), power = 8.266313e-01 (8.466000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.13 "" 1 # h2 full-length, UKBB power
# Power to detect OR = 2.13:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 26 -n 18022 -y 116 -m 344046 -o 2.13 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.224961e-07
# OR = 2.130000e+00 (Observed 4.288331e+00, p = 8.810754e-09), power = 7.316176e-01 (6.316000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 18022 -q 4.350922e-04 -m 344046 -o 2.13 -a 1e-5 -i -s 20200116
# OR = 2.130000e+00 (Observed 2.038136e+00, p = 1.103604e-02), power = 6.813871e-02 (5.930000e-02)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 18022 -q 4.350922e-04 -m 344046 -o 2.13 -a 1e-5 -i -c -s 20200116
# OR = 2.130000e+00 (Observed 2.038136e+00, p = 1.103604e-02), power = 5.620609e-02 (4.950000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h2 full-length, controls p-value
# Test difference in frequencies 0.000337164 0.000435092:
# python /home/wletsou/scripts/controls_frequency.py -x1 116 -n1 344046 -x2 22 -n2 50564 -pooled
# p = 2.714653E-01
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 116 -n1 344046 -x2 22 -n2 50564
# p = 2.532974E-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.h2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 full length, combined
# LRT p value = 1.761529e-03 on 1 degree(s) of freedom with OR = 2.168291e+00 (1.506773e+00 to 3.120235e+00), frequency = 4.178230e-04 (190) = 8.648217e-04/3.497124e-04 (52/138)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h2, combined expected cell counts
# Expected cell counts: a = 25.122862, b = 164.877138, c = 60102.877138, d = 394445.122862

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 2.13 "" 1 # h2 full-length, combined power
# Power to detect OR = 2.13:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 52 -n 60128 -y 138 -m 394610 -o 2.13 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.095523e-07
# OR = 2.130000e+00 (Observed 2.475471e+00, p = 2.451287e-07), power = 9.925149e-01 (9.756000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 60128 -q 4.350922e-04 -m 394610 -o 2.13 -a 0.05 -i -s 20200116
# OR = 2.130000e+00 (Observed 1.985875e+00, p = 4.313277e-05), power = 9.983541e-01 (9.918000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 8.648217e-04 -n 60128 -q 4.350922e-04 -m 394610 -o 2.13 -a 0.05 -i -c -s 20200116
# OR = 2.130000e+00 (Observed 1.985875e+00, p = 4.313277e-05), power = 9.972452e-01 (9.870000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 6.810697e-01 on 1 degree(s) of freedom with OR = 1.078953e+00 (6.346558e-01 to 1.834285e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 6.732595e-01 on 1 degree(s) of freedom with OR = 1.078602e+00 (6.338278e-01 to 1.835488e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # h3 reduced, DRIVE power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 30 -n 60128 -y 24 -m 50564 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.758035e-07
# OR = 1.080000e+00 (Observed 1.051236e+00, p = 8.920235e-01), power = 5.919772e-02 (5.060000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # h3 reduced, UKBB power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 17 -n 18022 -y 49 -m 344046 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.269509e-07
# OR = 1.080000e+00 (Observed 6.632975e+00, p = 1.678423e-08), power = 5.178157e-02 (3.640000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # h3 reduced, combined power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 30 -n 60128 -y 73 -m 394610 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.251385e-07
# OR = 1.080000e+00 (Observed 2.698733e+00, p = 2.533208e-05), power = 5.702595e-02 (5.440000e-02)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 full-length
# LRT p value = 6.611334e-01 on 1 degree(s) of freedom with OR = 1.062379e+00 (6.028558e-01 to 1.872169e+00), frequency = 4.426698e-04 (49) = 4.490420e-04/4.350922e-04 (27/22)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 full-length
# LRT p value = 6.820385e-01 on 1 degree(s) of freedom with OR = 1.074047e+00 (6.089254e-01 to 1.894446e+00), frequency = 4.426698e-04 (49) = 4.490420e-04/4.350922e-04 (27/22)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h3, DRIVE expected cell counts
# Expected cell counts: a = 26.616847, b = 22.383153, c = 60101.383153, d = 50541.616847

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h3, UKBB expected cell counts
# Expected cell counts: a = 3.285162, b = 62.714838, c = 18018.714838, d = 343983.285162

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.07 "" 1 # h3 full-length, DRIVE power
# Power to detect OR = 1.07:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 27 -n 60128 -y 22 -m 50564 -o 1.07 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 3.916624e-07
# OR = 1.070000e+00 (Observed 1.032095e+00, p = 1.000000e+00), power = 5.648000e-02 (4.420000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.07 "" 1 # h3 full-length, UKBB power
# Power to detect OR = 1.07:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 17 -n 18022 -y 49 -m 344046 -o 1.07 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.269509e-07
# OR = 1.070000e+00 (Observed 6.632975e+00, p = 1.678423e-08), power = 5.136451e-02 (3.990000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h3 full-length, controls p-value
# Test difference in frequencies 0.000142423 0.000435092:
# python /home/wletsou/scripts/controls_frequency.py -x1 49 -n1 344046 -x2 22 -n2 50564 -pooled
# p = 4.614567E-06
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 49 -n1 344046 -x2 22 -n2 50564
# p = 5.045835E-05

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 full length, combined
# LRT p value = 1.068797e-01 on 1 degree(s) of freedom with OR = 1.798927e+00 (1.097963e+00 to 2.947400e+00), frequency = 2.155087e-04 (98) = 4.490420e-04/1.799245e-04 (27/71)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h3, combined expected cell counts
# Expected cell counts: a = 12.958108, b = 85.041892, c = 60115.041892, d = 394524.958108

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.07 "" 1 # h3 full-length, combined power
# Power to detect OR = 1.07:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 27 -n 60128 -y 71 -m 394610 -o 1.07 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.094401e-07
# OR = 1.070000e+00 (Observed 2.497024e+00, p = 1.444354e-04), power = 5.523391e-02 (5.100000e-02)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 8.405460e-03 on 1 degree(s) of freedom with OR = 3.956833e+00 (1.484408e+00 to 1.054732e+01), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 9.110467e-03 on 1 degree(s) of freedom with OR = 3.925848e+00 (1.472199e+00 to 1.046888e+01), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 3.93 "" 1 # h4 reduced, DRIVE power
# Power to detect OR = 3.93:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 5 -m 50564 -o 3.93 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.413572e-07
# OR = 3.930000e+00 (Observed 3.533539e+00, p = 9.074014e-03), power = 7.930762e-01 (8.602000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 60128 -q 9.888458e-05 -m 50564 -o 3.93 -a 0.05 -i
# OR = 3.930000e+00 (Observed 3.533539e+00, p = 9.074014e-03), power = 7.930762e-01 (8.688000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 60128 -q 9.888458e-05 -m 50564 -o 3.93 -a 0.05 -i -c
# OR = 3.930000e+00 (Observed 3.533539e+00, p = 9.074014e-03), power = 7.497342e-01 (8.236000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 3.93 "" 1 # h4 reduced, UKBB power
# Power to detect OR = 3.93:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 6 -n 18022 -y 5 -m 344046 -o 3.93 -a 0.05 -i
# OR = 3.930000e+00 (Observed 2.292170e+01, p = 5.644092e-06), power = 2.439774e-01 (1.970000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 18022 -q 9.888458e-05 -m 344046 -o 3.93 -a 1e-5 -i
# OR = 3.930000e+00 (Observed 3.370395e+00, p = 1.358564e-02), power = 1.312265e-01 (8.370000e-02)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 18022 -q 9.888458e-05 -m 344046 -o 3.93 -a 1e-5 -i -c
# OR = 3.930000e+00 (Observed 3.370395e+00, p = 1.358564e-02), power = 9.838232e-02 (6.760000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 3.93 "" 1 # h4 reduced, combined power
# Power to detect OR = 3.93:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 10 -m 394610 -o 3.93 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 3.334945e-08
# OR = 3.930000e+00 (Observed 1.379065e+01, p = 4.047523e-12), power = 7.544259e-01 (6.684000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 60128 -q 9.888458e-05 -m 394610 -o 3.93 -a 0.05 -i
# OR = 3.930000e+00 (Observed 3.535686e+00, p = 1.511576e-05), power = 9.994622e-01 (9.932000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 3.492549e-04 -n 60128 -q 9.888458e-05 -m 394610 -o 3.93 -a 0.05 -i -c
# OR = 3.930000e+00 (Observed 3.535686e+00, p = 1.511576e-05), power = 9.986496e-01 (9.872000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 full-length
# LRT p value = 2.805067e-03 on 1 degree(s) of freedom with OR = 1.169116e+01 (1.530030e+00 to 8.933363e+01), frequency = 1.264771e-04 (14) = 2.162054e-04/1.977692e-05 (13/1)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 full-length
# LRT p value = 2.669127e-03 on 1 degree(s) of freedom with OR = 1.189058e+01 (1.553622e+00 to 9.100408e+01), frequency = 1.264771e-04 (14) = 2.162054e-04/1.977692e-05 (13/1)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h4, DRIVE expected cell counts
# Expected cell counts: a = 7.604813, b = 6.395187, c = 60120.395187, d = 50557.604813

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h4, UKBB expected cell counts
# Expected cell counts: a = 0.547527, b = 10.452473, c = 18021.452473, d = 344035.547527

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 11.9 "" 1 # h4 full-length, DRIVE power
# Power to detect OR = 11.9:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 13 -n 60128 -y 1 -m 50564 -o 11.9 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.111898e-08
# OR = 1.190000e+01 (Observed 1.093821e+01, p = 5.002757e-03), power = 6.676251e-01 (9.254000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 60128 -q 1.977692e-05 -m 50564 -o 11.9 -a 0.05 -i -s 20200116
# OR = 1.190000e+01 (Observed 1.093821e+01, p = 5.002757e-03), power = 6.676252e-01 (9.269000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 60128 -q 1.977692e-05 -m 50564 -o 11.9 -a 0.05 -i -c -s 20200116
# OR = 1.190000e+01 (Observed 1.093821e+01, p = 5.002757e-03), power = 6.310239e-01 (8.993000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 11.9 "" 1 # h4 full-length, UKBB power
# Power to detect OR = 11.9:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 6 -n 18022 -y 5 -m 344046 -o 11.9 -a 0.05 -i
# OR = 1.190000e+01 (Observed 2.292170e+01, p = 5.644092e-06), power = 9.293382e-01 (7.425000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 18022 -q 1.977692e-05 -m 344046 -o 11.9 -a 1e-5 -i -s 20200116
# OR = 1.190000e+01 (Observed 1.091281e+01, p = 1.525712e-03), power = 3.389877e-01 (1.748000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 18022 -q 1.977692e-05 -m 344046 -o 11.9 -a 1e-5 -i -c -s 20200116
# OR = 1.190000e+01 (Observed 1.091281e+01, p = 1.525712e-03), power = 2.808311e-01 (1.455000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h4 full-length, controls p-value
# Test difference in frequencies 1.45329e-05 1.97769e-05:
# python /home/wletsou/scripts/controls_frequency.py -x1 5 -n1 344046 -x2 1 -n2 50564 -pooled
# p = 7.776604E-01
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 5 -n1 344046 -x2 1 -n2 50564
# p = 5.607739E-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.h4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 full length, combined
# LRT p value = 2.118803e-03 on 1 degree(s) of freedom with OR = 6.894573e+00 (2.208959e+00 to 2.151925e+01), frequency = 4.178230e-05 (19) = 2.162054e-04/1.520489e-05 (13/6)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" h4, combined expected cell counts
#  Expected cell counts: a = 2.512286, b = 16.487714, c = 60125.487714, d = 394593.512286

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 11.9 "" 1 # h4 full-length, combined power
# Power to detect OR = 11.9:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 13 -n 60128 -y 6 -m 394610 -o 11.9 -a 0.05 -i
# OR = 1.190000e+01 (Observed 1.422494e+01, p = 4.667185e-08), power = 9.981905e-01 (9.920000e-01)

# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 60128 -q 1.977692e-05 -m 394610 -o 11.9 -a 0.05 -i -s 20200116
# OR = 1.190000e+01 (Observed 1.066806e+01, p = 2.697536e-07), power = 9.998368e-01 (9.977000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 2.162054e-04 -n 60128 -q 1.977692e-05 -m 394610 -o 11.9 -a 0.05 -i -c -s 20200116
# OR = 1.190000e+01 (Observed 1.066806e+01, p = 2.697536e-07), power = 9.996162e-01 (9.969000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h5 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h5 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h5 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h6 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h6 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h6.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h6 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" 11 68850000,69231641 "" "" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h7 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h7 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs12274095_A=0,rs73512137_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h7.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h7 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs117694794_T=0,rs61881109_A=0,rs10896449_G=1,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs117821797_T=0,rs117131950_A=0,rs73512137_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h8 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0:rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3,6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 and h6 reduced

# replication in pc-restricted sample

# /home/wletsou/scripts/dbgap28544_ukbb_phenotype_combine3.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.pcs.txt 0,1 dbgap28544.subset_ukbb_bca.pheno.txt

# effect of GWAS hit

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544.subset_ukbb_bca.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt "rs554219_G=1" "" "" "" "" rs554219 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps /home/wletsou/scripts
# LRT p value = 1.220010e-11 on 1 degree(s) of freedom with OR = 1.166554e+00 (1.115569e+00 to 1.219869e+00), frequency = 1.330594e-01 (9196) = 1.409916e-01/1.235526e-01 (5312/3884)

# LD with GWAS hit

# bsub -P SJLIFE -J ukbb_haplotype_haplotype_LD2 -oo ukbb_haplotype_haplotype_LD2.out -eo ukbb_haplotype_haplotype_LD2.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.69231642-69431642.txt \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" \"rs554219_G=1\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/dbgap28544_imputed_snps" # h1 (reduced) vs GWAS hit

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh dbgap28544.subset_ukbb_bca.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h1 reduced
# LRT p value = 5.317818e-11 on 1 degree(s) of freedom with OR = 1.179799e+00 (1.122739e+00 to 1.239758e+00), frequency = 1.039327e-01 (7183) = 1.109460e-01/9.552742e-02 (4180/3003)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh dbgap28544.subset_ukbb_bca.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 6.033882e-02 on 1 degree(s) of freedom with OR = 2.064215e+00 (1.126852e+00 to 3.781318e+00), frequency = 7.379326e-04 (51) = 9.555154e-04/4.771599e-04 (36/15)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh dbgap28544.subset_ukbb_bca.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 3.873854e-01 on 1 degree(s) of freedom with OR = 8.831038e-01 (4.575577e-01 to 1.704424e+00), frequency = 4.919551e-04 (34) = 4.512156e-04/5.407813e-04 (17/17)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh dbgap28544.subset_ukbb_bca.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 5.844642e-02 on 1 degree(s) of freedom with OR = 6.330692e+00 (7.752762e-01 to 5.169469e+01), frequency = 1.157541e-04 (8) = 1.857947e-04/3.181066e-05 (7/1)

# power

# module load R/3.6.1

# for or in 2 3 5 10; do for y in 3.44046   17.20230 34.40460 172.02300 344.04600 1720.23000; do echo Rscript /home/wletsou/scripts/fisher_power2.R \-x 1 \-n 18022 \-y $y \-m 344046 \-o $or \-a 1e-5 \-i; Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y $y -m 344046 -o $or -a 1e-5 -i; printf "\n"; done; done
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 3.44046 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 2.673375e-05 (0.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 17.20230 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 2.022534e-04 (1.000000e-04)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 34.40460 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 7.547229e-04 (1.300000e-03)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 172.02300 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 5.246934e-02 (5.030000e-02)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 344.04600 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 3.197600e-01 (2.255000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 1720.23000 -m 344046 -o 2 -a 1e-5 -i
# NULL
# power = 9.999923e-01 (9.989000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 3.44046 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 1.013699e-04 (0.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 17.20230 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 2.995776e-03 (3.400000e-03)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 34.40460 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 1.982194e-02 (1.960000e-02)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 172.02300 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 8.109360e-01 (5.944000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 344.04600 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 9.988946e-01 (9.654000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 1720.23000 -m 344046 -o 3 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 3.44046 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 8.240275e-04 (8.000000e-04)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 17.20230 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 8.149824e-02 (5.560000e-02)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 34.40460 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 4.424493e-01 (2.416000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 172.02300 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 9.999999e-01 (9.988000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 344.04600 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 1720.23000 -m 344046 -o 5 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 3.44046 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 1.880315e-02 (1.600000e-02)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 17.20230 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 8.740326e-01 (5.611000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 34.40460 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 9.997145e-01 (9.515000e-01)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 172.02300 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 344.04600 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)
# Rscript /home/wletsou/scripts/fisher_power2.R -x 1 -n 18022 -y 1720.23000 -m 344046 -o 10 -a 1e-5 -i
# NULL
# power = 1.000000e+00 (1.000000e+00)

# for or in 2 3 5 10; do for q in 0.00001 0.00005 0.0001 0.0005 0.001 0.005; do echo Rscript /home/wletsou/scripts/fisher_power3.R \-p 1 \-n 18022 \-q $q \-m 344046 \-o $or \-a 1e-5 \-i; Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q $q -m 344046 -o $or -a 1e-5 -i; printf "\n"; done; done

# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00001 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.121143e-06
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 2.968644e-05 (0.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00005 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.357011e-06
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 2.062846e-04 (3.000000e-04)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0001 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.724018e-06
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 7.741270e-04 (1.200000e-03)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0005 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 7.669061e-07
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 5.248932e-02 (4.910000e-02)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.001 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.530812e-06
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 3.198539e-01 (2.245000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.005 -m 344046 -o 2 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.668652e-06
# OR = 2.000000e+00 (Observed Inf, p = 0.000000e+00), power = 9.999923e-01 (9.996000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00001 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.121143e-06
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 1.231835e-04 (3.000000e-04)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00005 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.357011e-06
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 3.087447e-03 (3.700000e-03)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0001 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.724018e-06
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 2.050379e-02 (1.850000e-02)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0005 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 7.669061e-07
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 8.110315e-01 (6.002000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.001 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.530812e-06
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 9.988964e-01 (9.660000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.005 -m 344046 -o 3 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.668652e-06
# OR = 3.000000e+00 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00001 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.121143e-06
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 1.116903e-03 (1.200000e-03)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00005 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.357011e-06
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 8.423317e-02 (5.540000e-02)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0001 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.724018e-06
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 4.524585e-01 (2.627000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0005 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 7.669061e-07
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 9.999999e-01 (9.981000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.001 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.530812e-06
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.005 -m 344046 -o 5 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.668652e-06
# OR = 5.000000e+00 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00001 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.121143e-06
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 2.784844e-02 (2.190000e-02)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.00005 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.357011e-06
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 8.807256e-01 (5.644000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0001 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.724018e-06
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 9.997598e-01 (9.534000e-01)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.0005 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 7.669061e-07
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.001 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.530812e-06
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)
#
# Rscript /home/wletsou/scripts/fisher_power3.R -p 1 -n 18022 -q 0.005 -m 344046 -o 10 -a 1e-5 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.668652e-06
# OR = 1.000000e+01 (Observed Inf, p = 0.000000e+00), power = 1.000000e+00 (1.000000e+00)

# combined controls haplotype file
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_controls.indiv dbgap28544_controls.indiv > ukbb_bca_controls+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_controls+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 2.10 # h2 full-length, DRIVE power
# Power to detect OR = 2.10:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 52 -n 60128 -y 22 -m 50564 -o 2.10 -a 0.05
# OR = 2.100000e+00 (Observed 1.988484e+00, p = 6.874466e-03), power = 8.363726e-01 (8.579000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h2 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 116 -n1 344046 -x2 22 -n2 50564 -pooled
# p = 2.714653E-01

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 2.10 # h2 full-length, combined power
# Power to detect OR = 2.10:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 52 -n 60128 -y 138 -m 394610 -o 2.10 -a 0.05
# OR = 2.100000e+00 (Observed 2.474201e+00, p = 2.466501e-07), power = 9.900787e-01 (9.690000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.98 # h2 reduced, DRIVE power
# Power to detect OR = 1.98:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 61 -n 60128 -y 27 -m 50564 -o 1.98 -a 0.05
# OR = 1.980000e+00 (Observed 1.900776e+00, p = 5.140873e-03), power = 8.443501e-01 (8.593000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h2 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 116 -n1 344046 -x2 27 -n2 50564 -pooled
# p = 2.991887E-02
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 116 -n1 344046 -x2 27 -n2 50564
# p = 4.386108E-02

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.98 # h2 reduced, combined power
# Power to detect OR = 1.98:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 61 -n 60128 -y 143 -m 394610 -o 1.98 -a 0.05
# OR = 1.980000e+00 (Observed 2.801349e+00, p = 5.406419e-10), power = 9.756307e-01 (9.412000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.06 # h3 full-length, DRIVE power
# Power to detect OR = 1.06:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 27 -n 60128 -y 22 -m 50564 -o 1.06 -a 0.05
# OR = 1.060000e+00 (Observed 1.032081e+00, p = 1.000000e+00), power = 5.478276e-02 (4.480000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h3 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 49 -n1 344046 -x2 22 -n2 50564 -pooled
# p = 4.614567E-06

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.06 # h3 full-length, combined power
# Power to detect OR = 1.06:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 27 -n 60128 -y 71 -m 394610 -o 1.06 -a 0.05
# OR = 1.060000e+00 (Observed 2.496359e+00, p = 1.446954e-04), power = 5.384804e-02 (5.130000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.08 # h3 reduced, DRIVE power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 30 -n 60128 -y 24 -m 50564 -o 1.08 -a 0.05
# OR = 1.080000e+00 (Observed 1.051211e+00, p = 8.920497e-01), power = 5.920023e-02 (5.190000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h3 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 49 -n1 344046 -x2 24 -n2 50564 -pooled
# p = 2.911951E-07
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 49 -n1 344046 -x2 24 -n2 50564
# p = 7.627765E-06

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 1.08 # h3 reduced, combined power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 30 -n 60128 -y 73 -m 394610 -o 1.08 -a 0.05
# OR = 1.080000e+00 (Observed 2.697893e+00, p = 2.538834e-05), power = 5.702678e-02 (5.490000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 11.7 # h4 full-length, DRIVE power
# Power to detect OR = 11.7:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 13 -n 60128 -y 1 -m 50564 -o 11.7 -a 0.05
# OR = 1.170000e+01 (Observed 1.093621e+01, p = 5.005311e-03), power = 6.611824e-01 (9.155000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h4 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 5 -n1 344046 -x2 1 -n2 50564 -pooled
# p = 7.776604E-01

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 11.7 # h4 full-length, combined power
# Power to detect OR = 11.7:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 13 -n 60128 -y 6 -m 394610 -o 11.7 -a 0.05
# OR = 1.170000e+01 (Observed 1.422224e+01, p = 4.671730e-08), power = 9.978947e-01 (9.897000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 3.96 # h4 reduced, DRIVE power
# Power to detect OR = 3.96:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 5 -m 50564 -o 3.96 -a 0.05
# OR = 3.960000e+00 (Observed 3.532688e+00, p = 9.081882e-03), power = 7.980424e-01 (8.775000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # h4 reduced, controls p-value
# Test difference in frequencies:
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 5 -n1 344046 -x2 5 -n2 50564 -pooled
# p = 4.343855E-04
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 5 -n1 344046 -x2 5 -n2 50564
# p = 4.969556E-03

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 3.96 # h4 reduced, combined power
# Power to detect OR = 3.96:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 10 -m 394610 -o 3.96 -a 0.05
# OR = 3.960000e+00 (Observed 1.378633e+01, p = 4.058097e-12), power = 7.610458e-01 (6.629000e-01)

# combined controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv ukbb_bca_controls.indiv > dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt

# /home/wletsou/scripts/dbgap28544_ukbb_phenotype_combine.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 5.859817e-07 on 1 degree(s) of freedom with OR = 2.747607e+00 (2.030041e+00 to 3.718814e+00), frequency = 4.486100e-04 (204) = 1.014502e-03/3.623831e-04 (61/143)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs74897859_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 full-length
# LRT p value = 7.030609e-05 on 1 degree(s) of freedom with OR = 2.414081e+00 (1.749793e+00 to 3.330559e+00), frequency = 4.178230e-04 (190) = 8.648217e-04/3.497124e-04 (52/138)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 1.527118e-03 on 1 degree(s) of freedom with OR = 2.504867e+00 (1.637060e+00 to 3.832699e+00), frequency = 2.265041e-04 (103) = 4.989356e-04/1.849928e-04 (30/73)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 full-length
# LRT p value = 5.533101e-03 on 1 degree(s) of freedom with OR = 2.363058e+00 (1.510916e+00 to 3.695798e+00), frequency = 2.155087e-04 (98) = 4.490420e-04/1.799245e-04 (27/71)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 1.963451e-10 on 1 degree(s) of freedom with OR = 1.327291e+01 (6.201433e+00 to 2.840797e+01), frequency = 6.817112e-05 (31) = 3.492549e-04/2.534148e-05 (21/10)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 full-length
# LRT p value = 2.118194e-07 on 1 degree(s) of freedom with OR = 1.469538e+01 (5.541149e+00 to 3.897280e+01), frequency = 4.178230e-05 (19) = 2.162054e-04/1.520489e-05 (13/6)

# combine controls with pc adjustment

# /home/wletsou/scripts/dbgap28544_ukbb_phenotype_combine2.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.pcs.txt ukb.bca_dbgap28544.pheno.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukb.bca_dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 2.631760e-04 on 1 degree(s) of freedom with OR = 2.310131e+00 (1.634053e+00 to 3.265933e+00), frequency = 4.486100e-04 (204) = 1.014502e-03/3.623831e-04 (61/143)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukb.bca_dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 2.350943e-01 on 1 degree(s) of freedom with OR = 1.603573e+00 (9.796875e-01 to 2.624762e+00), frequency = 2.265041e-04 (103) = 4.989356e-04/1.849928e-04 (30/73)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukb.bca_dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 1.525723e-04 on 1 degree(s) of freedom with OR = 6.612298e+00 (2.680182e+00 to 1.631325e+01), frequency = 6.817112e-05 (31) = 3.492549e-04/2.534148e-05 (21/10)

# combined pca with no 1kG

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h1 reduced
# LRT p value = 2.441277e-27 on 1 degree(s) of freedom with OR = 1.186348e+00 (1.150675e+00 to 1.223125e+00), frequency = 9.742973e-02 (44305) = 1.135078e-01/9.497985e-02 (6825/37480)

# factor      OR           ll           ul           p
# [1,] (Intercept)  2.59046e-01  2.36234e-01  2.84059e-01 2.11919e-181
# [2,] age          9.87042e-01  9.85619e-01  9.88467e-01  2.91776e-70
# [3,] pc01        7.35779e-154 3.67114e-156 1.47467e-151  0.00000e+00
# [4,] pc02        2.79853e-105 1.55558e-107 5.03462e-103  0.00000e+00
# [5,] pc03         2.91352e+11  2.78581e+08  3.04709e+14  9.94264e-14
# [6,] pc04         9.98262e-34  9.92867e-37  1.00369e-30 6.13242e-103
# [7,] pc05         9.21322e-36  7.97250e-39  1.06470e-32 2.50928e-111
# [8,] pc06         1.08835e+06  1.25545e+03  9.43493e+08  5.64401e-05
# [9,] pc07         8.14021e-05  1.06035e-07  6.24914e-02  5.46968e-03
# [10,] pc08         4.27295e+06  6.86418e+03  2.65991e+09  3.30073e-06
# [11,] pc09         2.21896e-15  2.87273e-18  1.71397e-12  2.63972e-23
# [12,] pc10         1.21833e+12  1.09432e+09  1.35638e+15  7.54087e-15

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 4.732059e-04 on 1 degree(s) of freedom with OR = 2.252738e+00 (1.592559e+00 to 3.186588e+00), frequency = 4.486100e-04 (204) = 1.014502e-03/3.623831e-04 (61/143)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 1.020669e-01 on 1 degree(s) of freedom with OR = 1.772935e+00 (1.105990e+00 to 2.842066e+00), frequency = 2.265041e-04 (103) = 4.989356e-04/1.849928e-04 (30/73)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 2.766766e-04 on 1 degree(s) of freedom with OR = 6.095225e+00 (2.502128e+00 to 1.484807e+01), frequency = 6.817112e-05 (31) = 3.492549e-04/2.534148e-05 (21/10)

# matched analysis

# matched groups from pc2_g1, pc2_g2, pc2_g3
# awk 'FILENAME==ARGV[1]{print $0; group_total1=$NF; next} (FILENAME==ARGV[2] && FNR>1){$NF=$NF+group_total1;print $0; group_total2=$NF; next}  (FILENAME==ARGV[3] && FNR>1){$NF=$NF+group_total2;print $0; group_total3=$NF; next} (FILENAME==ARGV[4] && FNR>1){$NF=$NF+group_total3;print $0; group_total4=$NF; next}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc2_g1.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc2_g2.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc2_g3.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc2_g4.txt > /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc2.txt

# matched groups from pc1_lower,pc1_upper
# awk 'FILENAME==ARGV[1]{print $0; group_total1=$NF; next} (FILENAME==ARGV[2] && FNR>1){$NF=$NF+group_total1;print $0; group_total2=$NF; next}' /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1_lower.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1_upper.txt > /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1.txt

#combined phenotypes file (DRIVE and UKBB cases and controls)
# /home/wletsou/scripts/dbgap28544_ukbb_phenotype_combine2.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.pcs.txt ukb.bca_dbgap28544.pheno.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh ukb.bca_dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 8.650259e-07 on 1 degree(s) of freedom with HR = 2.900000e+00 (2.077275e+00 to 4.048572e+00), frequency = 4.789782e-04 (144) = 1.014502e-03/3.450971e-04 (61/83)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh ukb.bca_dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 8.074022e-03 on 1 degree(s) of freedom with HR = 2.303475e+00 (1.459170e+00 to 3.636311e+00), frequency = 2.627728e-04 (79) = 4.989356e-04/2.037320e-04 (30/49)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh ukb.bca_dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/pc1.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 1.214018e-07 on 1 degree(s) of freedom with HR = 9.088385e+00 (4.138651e+00 to 1.995789e+01), frequency = 9.978712e-05 (30) = 3.492549e-04/3.742017e-05 (21/9)

# awk 'BEGIN{OFS="\t"} NR>1&&$2==0{seen[$1]+=1} END{for (i in seen) {total[seen[i]]+=1}; n=asorti(total,dest,"@ind_num_asc"); for (i=1;i<=n;i++) {print dest[i],total[dest[i]]} }'  /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m4.txt # how many controls appear i times

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m4.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m4.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 4.040644e-03 on 1 degree(s) of freedom with HR = 1.904748e+00 (1.400049e+00 to 2.591384e+00), frequency = 6.220064e-04 (187) = 1.014502e-03/5.238824e-04 (61/126)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m4.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m4.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 7.097757e-01 on 1 degree(s) of freedom with HR = 1.111255e+00 (7.430267e-01 to 1.661969e+00), frequency = 4.723257e-04 (142) = 4.989356e-04/4.656732e-04 (30/112)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m4.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m4.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 2.522326e-04 on 1 degree(s) of freedom with HR = 3.768296e+00 (2.080543e+00 to 6.825169e+00), frequency = 1.463544e-04 (44) = 3.492549e-04/9.562932e-05 (21/23)

# awk 'BEGIN{OFS="\t"} NR>1&&$2==0{seen[$1]+=1} END{for (i in seen) {total[seen[i]]+=1}; n=asorti(total,dest,"@ind_num_asc"); for (i=1;i<=n;i++) {print dest[i],total[dest[i]]} }'  /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m10.txt # how many controls appear i times

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m10.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m10.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 3.151347e-04 on 1 degree(s) of freedom with HR = 2.062820e+00 (1.564466e+00 to 2.719922e+00), frequency = 5.382457e-04 (356) = 1.014502e-03/4.906200e-04 (61/295)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m10.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m10.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 8.109343e-01 on 1 degree(s) of freedom with HR = 1.151410e+00 (7.895388e-01 to 1.679137e+00), frequency = 4.550897e-04 (301) = 4.989356e-04/4.507052e-04 (30/271)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/drive_only_m10.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544_conditional.m10.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced

# grouping cases and controls into quantile groups

# /home/wletsou/scripts/dbgap28544_pc_percentiles.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt 5 5 dbgap28544_groups.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" "" dbgap28544_strata.0pcs.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 1.396609e-01 on 1 degree(s) of freedom with HR = 1.324733e+00 (1.022875e+00 to 1.715672e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)
# LRT p value = 2.574722e-02 on 1 degree(s) of freedom with HR = 1.528828e+00 (1.179151e+00 to 1.982201e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" "" dbgap28544_strata.0pcs.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 7.907960e-01 on 1 degree(s) of freedom with HR = 1.034149e+00 (7.246154e-01 to 1.475905e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)
# LRT p value = 6.509602e-01 on 1 degree(s) of freedom with HR = 1.035357e+00 (7.226077e-01 to 1.483466e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" "" dbgap28544_strata.0pcs.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 1.171179e-01 on 1 degree(s) of freedom with HR = 1.569949e+00 (1.012610e+00 to 2.434049e+00), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)
# LRT p value = 1.238420e-02 on 1 degree(s) of freedom with HR = 2.074411e+00 (1.335396e+00 to 3.222400e+00), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs78033785_T=0,rs117694794_T=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs7103126_C=1,rs12274095_A=0,rs12789955_G=0,rs72932198_A=0,rs61882193_G=0,rs12790064_G=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "6,7,8,9,10" "" dbgap28544_strata.5pcs.h2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h2 reduced
# LRT p value = 1.326498e-01 on 1 degree(s) of freedom with HR = 1.329883e+00 (1.026769e+00 to 1.722479e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)
# LRT p value = 2.358218e-02 on 1 degree(s) of freedom with HR = 1.536977e+00 (1.185301e+00 to 1.992995e+00), frequency = 7.949987e-04 (88) = 1.014502e-03/5.339767e-04 (61/27)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "6,7,8,9,10" "" dbgap28544_strata.5pcs.h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h3 reduced
# LRT p value = 7.898221e-01 on 1 degree(s) of freedom with HR = 1.033997e+00 (7.244424e-01 to 1.475824e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)
# LRT p value = 6.514514e-01 on 1 degree(s) of freedom with HR = 1.035775e+00 (7.229040e-01 to 1.484057e+00), frequency = 4.878401e-04 (54) = 4.989356e-04/4.746460e-04 (30/24)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit_conditional.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt dbgap28544_groups.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs3892895_G=1,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs11228565_A=0,rs116951063_T=0,rs11825015_T=0,rs74551015_A=0,rs11539762_A=0,rs7124547_T=1,rs11603814_G=1,rs79487139_T=0,rs4275647_T=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "6,7,8,9,10" "" dbgap28544_strata.5pcs.h4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2 /home/wletsou/scripts # h4 reduced
# LRT p value = 1.172537e-01 on 1 degree(s) of freedom with HR = 1.570204e+00 (1.012477e+00 to 2.435158e+00), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)
# LRT p value = 1.298499e-02 on 1 degree(s) of freedom with HR = 2.066406e+00 (1.329813e+00 to 3.211004e+00), frequency = 2.348860e-04 (26) = 3.492549e-04/9.888458e-05 (21/5)

# mkdir replication
# cp dbgap28544_cases.indiv replication/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv replication/dbgap28544_controls.indiv
# cp CCND1_TAD_snps.chr11.68850000-69231641.txt replication/CCND1_TAD_snps.chr11.68850000-69231641.txt
# cd replication

# get haplotypes as HDS values
# bsub -P SJLIFE -J dbgap_haplotype_extract4 -oo dbgap_haplotype_extract4.out -eo dbgap_haplotype_extract4.err -R "rusage[mem=10000]" -q large_mem "sh /home/wletsou/scripts/dbgap_haplotype_extract4.sh dbgap28544_cases.indiv,dbgap28544_controls.indiv "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# allele-drop with junk.sum < 0.5
# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.01 1 100.1 2 h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h3 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.1 1 100.1 2 h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h3 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 10 h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h3 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs74897859_T=0,rs67039008_A=1,rs17149775_G=1,rs11228530_C=0,rs12418948_T=0,rs61881109_A=0,rs10896449_G=1,rs7130881_G=0,rs7103126_C=0,rs11603814_G=0,rs12789955_G=0,rs79487139_T=0,rs11600497_A=0,rs12790064_G=1,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 2 100.1 2 h3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h3 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=1,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12790064_G=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 10 h3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h3 full-length

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs67039008_A=0,rs11228530_C=0,rs4495899_G=1,rs11228565_A=0,rs7931342_G=1,rs111762835_A=0,rs56103266_C=0,rs7124547_T=0,rs4275647_T=0,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 2 h5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h5 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 2 h5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h5 full-length

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 2 100.1 2 h5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h5 full-length

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.01 1 100.1 2 h6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h6 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.1 1 100.1 2 h6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h6 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 10 h6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h6 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs7116054_T=0,rs74897859_T=0,rs17149775_G=0,rs11228530_C=0,rs17309046_C=0,rs11228599_T=1,rs56103266_C=0,rs10896461_G=0,rs11603814_G=0,rs7481709_C=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 2 100.1 2 h6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h6 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 10 h6.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h6 full-length

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.01 1 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.025 1 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.05 1 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.1 1 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs10896431_T=0,rs17308715_T=0,rs67039008_A=1,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs12418948_T=0,rs117694794_T=0,rs75590802_A=0,rs7931342_G=0,rs78656034_T=0,rs12275849_C=0,rs116926312_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs12790064_G=1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 2 100.1 2 h7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 reduced

# bsub -P SJLIFE -J dbgap28544_allele_drop_sub -oo dbgap28544_allele_drop_sub.out -eo dbgap28544_allele_drop_sub.err -R "rusage[mem=256]" -q standard "/home/wletsou/scripts/dbgap28544_allele_drop_sub.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs12274095_A=0,rs73512137_T=0,rs10896461_G=1,rs7124547_T=1,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 0.5 1 100.1 2 h7.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/replication /home/wletsou/scripts" # h7 full-length

# permutation analysis of h1-carriers
# mkdir UKBB_chr11.34/phase2.1
# cd UKBB_chr11.34
# cp dbgap28544_cases.indiv phase2.1/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv phase2.1/dbgap28544_controls.indiv
# cd phase2.1

# mkdir h1.full-length
# cd h1.full-length

# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200116 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt"

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.68850000-69231641 -oo ukbb_haplotype_extract3.chr11.68850000-69231641.out -eo ukbb_haplotype_extract3.chr11.68850000-69231641.err -R "rusage[mem=20000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv,dbgap28544_cases.indiv,dbgap28544_controls.indiv \"CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt\" \"/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info\" 11 68850000,69231641 \"/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts"

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" h1 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts
# LRT p value = 1.132575e-21 on 1 degree(s) of freedom with HR = 1.256218e+00 (1.200472e+00 to 1.314553e+00), frequency = 9.579968e-02 (34686) = 1.165242e-01/9.471408e-02 (2100/32586)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g3 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length/g2-g3.new_allele_counts.txt groups=1,2,3 verbose=1 n=2 n_covs=10
# [1] "X000" "X100" "X101" "X110"
# [1] "DT[,h0:=X000]"
# [1] "DT[,h1.3:=X100+X101]"
# [1] "DT[,h1:=X100]"
# [1] "DT[,h2:=X110]"
# [1] "DT[,h3:=X101]"
#
#    affected  h1.3    h1  h2 h3
# 1:        0 32477 32436 109 41
# 2:        1  2072  2056  28 16
#
#    affected       h1.3         h1           h2           h3
# 1:        0 0.09439726 0.09427809 0.0003168181 0.0001191701
# 2:        1 0.11497059 0.11408279 0.0015536566 0.0008878038
#
#     h1.3    h1  h2 h3
# 1: 34549 34492 137 57
#
#         h1.3         h1          h2          h3
# 1: 0.0954213 0.09526387 0.000378382 0.000157429
#
# Surv(age,affected) ~ h1 + h2 + h3 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2125336  1.2368077  0.0233768  9.092  < 2e-16 ***
# h2    1.5223960  4.5831934  0.1893273  8.041 8.91e-16 ***
# h3    1.8217172  6.1824657  0.2503672  7.276 3.43e-13 ***
# pc01 -0.0104812  0.9895736  0.0069204 -1.515  0.12989
# pc02 -0.0189679  0.9812109  0.0071613 -2.649  0.00808 **
# pc03  0.0084801  1.0085162  0.0069063  1.228  0.21949
# pc04  0.0009161  1.0009166  0.0051806  0.177  0.85963
# pc05  0.0006637  1.0006639  0.0022633  0.293  0.76934
# pc06 -0.0034039  0.9966019  0.0065739 -0.518  0.60460
# pc07  0.0081060  1.0081390  0.0059125  1.371  0.17037
# pc08  0.0010295  1.0010300  0.0058856  0.175  0.86115
# pc09 -0.0006585  0.9993417  0.0022974 -0.287  0.77438
# pc10  0.0033204  1.0033259  0.0050903  0.652  0.51421
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2368     0.8085    1.1814    1.2948
# h2      4.5832     0.2182    3.1624    6.6424
# h3      6.1825     0.1617    3.7849   10.0989
# pc01    0.9896     1.0105    0.9762    1.0031
# pc02    0.9812     1.0191    0.9675    0.9951
# pc03    1.0085     0.9916    0.9950    1.0223
# pc04    1.0009     0.9991    0.9908    1.0111
# pc05    1.0007     0.9993    0.9962    1.0051
# pc06    0.9966     1.0034    0.9838    1.0095
# pc07    1.0081     0.9919    0.9965    1.0199
# pc08    1.0010     0.9990    0.9895    1.0126
# pc09    0.9993     1.0007    0.9949    1.0039
# pc10    1.0033     0.9967    0.9934    1.0134
#
# Concordance= 0.496  (se = 0.003 )
# Likelihood ratio test= 163.4  on 13 df,   p=<2e-16
# Wald test            = 210  on 13 df,   p=<2e-16
# Score (logrank) test = 237.9  on 13 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g3.new_allele_counts.txt n=2 groups=1,2,3 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 1.372033e-08
# 2:             h3 3.767774e-07

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts # h1 full-length
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts # g2 full-length
# LRT p value = 6.628600e-01 on 1 degree(s) of freedom with OR = 1.355946e+00 (7.976714e-01 to 2.304948e+00), frequency = 5.239764e-04 (58) = 5.820915e-04/4.548691e-04 (35/23)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/h1.full-length /home/wletsou/scripts # g3 full-length
# LRT p value = 9.452483e-01 on 1 degree(s) of freedom with OR = 1.223160e+00 (8.139240e-01 to 1.838158e+00), frequency = 8.763054e-04 (97) = 9.479776e-04/7.910767e-04 (57/40)

# cd .. # phase2.1

# get h1 and list of SNPs in upstream region
# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.chr11.68850000-69231641.txt

# check that SNPs have good "imputation" quality
# awk 'NR==FNR{snp[$1]; next} ($8 in snp && $15==1){print $8}' CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info > CCND1_TAD_snps.chr11.68850000-69231641.tmp
# test -f CCND1_TAD_snps.chr11.68850000-69231641.tmp && mv CCND1_TAD_snps.chr11.68850000-69231641.tmp CCND1_TAD_snps.chr11.68850000-69231641.txt

# vcf files of region (dbGaP only, UKBB exists)

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200116 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# first round of overlaps (of h1-carrying chromosomes among cases)
# bsub -P SJLIFE -J ukbb_bca_overlap.chr11.68850000-69231641 -oo ukbb_bca_overlap.chr11.68850000-69231641.out -eo ukbb_bca_overlap.chr11.68850000-69231641.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_submission13.sh ukbb_bca_cases,ukbb_bca_controls,dbgap28544_cases,dbgap28544_controls 11 68850000,69231641 "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 0.0001 \"\" \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts"

# set a threshold for remaining overlaps
# mv Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# awk 'BEGIN{OFS="\t"} NR==FNR{count[$2]=$1; next} ($1 in count){print count[$1],$1}' Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt <(awk '($5+0<1e-5){print $0}' Pattern_differences.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.p_vals.txt | awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=n; seen[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=$1} } END{for (i in seen) {print seen[i]} }') > Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# Begin iterations:
# bsub -P SJLIFE -J pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/pattern_overlap_iterate3.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.subset.txt 11 68850000,69231641 100 50 2 2,j \"\" \"ukbb_bca_cases\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts"

# sh /home/wletsou/scripts/ukbb_pattern_count_summary.sh ukbb_bca_cases 11 68850000,69231641 2,j

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# forward selection
# translated in parallel, p <
# test -f fisher_exact.ukbb_bca_cases.Results.txt && rm fisher_exact.ukbb_bca_cases.Results.txt; touch fisher_exact.ukbb_bca_cases.Results.txt; for file in fisher_exact.ukbb_bca_cases.Iteration*.txt; do awk '($6+0<1e-2){print $0}' $file >> fisher_exact.ukbb_bca_cases.Results.txt; done;

# remove longer patterns with the same frequency, OR, and p-value as a shorter pattern
# awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=n; seen[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=$0} }  END{for (i in seen) {print seen[i]} }' fisher_exact.ukbb_bca_cases.Results.txt > fisher_exact.ukbb_bca_cases.Results.tmp; test -f fisher_exact.ukbb_bca_cases.Results.tmp && mv fisher_exact.ukbb_bca_cases.Results.tmp fisher_exact.ukbb_bca_cases.Results.txt

# bsub -P SJLIFE -J ukbb_haplotype_translate2_sub -oo ukbb_haplotype_translate2_sub.out -eo ukbb_haplotype_translate2_sub.err -R "rusage[mem=256]" -q standard "sh /home/wletsou/scripts/ukbb_haplotype_translate2_sub.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt fisher_exact.ukbb_bca_cases.Results.txt 50"

# bsub -P SJLIFE -J ukbb_haplotype_model9_sub -oo ukbb_haplotype_model9_sub.out -eo ukbb_haplotype_model9_sub.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_sub.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt fisher_exact.ukbb_bca_cases.Results.translated.txt 1 \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" 1 11 68850000,69231641 50 \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_model9_iterate -oo ukbb_haplotype_model9_iterate.out -eo ukbb_haplotype_model9_iterate.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_iterate.sh allele_counts.txt ukb.bca.pheno.txt 1 1 0.01 Significant_patterns.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts"

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<0.01 && $3 > 1){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs74674490_G=0,rs72930627_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g5 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g5.new_allele_counts.txt n=4 groups=1,2,3,4,5 threshold=0.05 n_covs=10

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<1e-5){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g3 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/g2-g3.new_allele_counts.txt groups=1,2,3 verbose=1 n=2 n_covs=10
# [1] "X000" "X100" "X101" "X110"
# [1] "DT[,h0:=X000]"
# [1] "DT[,h1.3:=X100+X101]"
# [1] "DT[,h1:=X100]"
# [1] "DT[,h2:=X110]"
# [1] "DT[,h3:=X101]"
#
#    affected  h1.3    h1  h2 h3
# 1:        0 32477 32436 109 41
# 2:        1  2072  2056  28 16
#
#    affected       h1.3         h1           h2           h3
# 1:        0 0.09439726 0.09427809 0.0003168181 0.0001191701
# 2:        1 0.11497059 0.11408279 0.0015536566 0.0008878038
#
#     h1.3    h1  h2 h3
# 1: 34549 34492 137 57
#
#         h1.3         h1          h2          h3
# 1: 0.0954213 0.09526387 0.000378382 0.000157429
#
# Surv(age,affected) ~ h1 + h2 + h3 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2125336  1.2368077  0.0233768  9.092  < 2e-16 ***
# h2    1.5223960  4.5831934  0.1893273  8.041 8.91e-16 ***
# h3    1.8217172  6.1824657  0.2503672  7.276 3.43e-13 ***
# pc01 -0.0104812  0.9895736  0.0069204 -1.515  0.12989
# pc02 -0.0189679  0.9812109  0.0071613 -2.649  0.00808 **
# pc03  0.0084801  1.0085162  0.0069063  1.228  0.21949
# pc04  0.0009161  1.0009166  0.0051806  0.177  0.85963
# pc05  0.0006637  1.0006639  0.0022633  0.293  0.76934
# pc06 -0.0034039  0.9966019  0.0065739 -0.518  0.60460
# pc07  0.0081060  1.0081390  0.0059125  1.371  0.17037
# pc08  0.0010295  1.0010300  0.0058856  0.175  0.86115
# pc09 -0.0006585  0.9993417  0.0022974 -0.287  0.77438
# pc10  0.0033204  1.0033259  0.0050903  0.652  0.51421
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2368     0.8085    1.1814    1.2948
# h2      4.5832     0.2182    3.1624    6.6424
# h3      6.1825     0.1617    3.7849   10.0989
# pc01    0.9896     1.0105    0.9762    1.0031
# pc02    0.9812     1.0191    0.9675    0.9951
# pc03    1.0085     0.9916    0.9950    1.0223
# pc04    1.0009     0.9991    0.9908    1.0111
# pc05    1.0007     0.9993    0.9962    1.0051
# pc06    0.9966     1.0034    0.9838    1.0095
# pc07    1.0081     0.9919    0.9965    1.0199
# pc08    1.0010     0.9990    0.9895    1.0126
# pc09    0.9993     1.0007    0.9949    1.0039
# pc10    1.0033     0.9967    0.9934    1.0134
#
# Concordance= 0.496  (se = 0.003 )
# Likelihood ratio test= 163.4  on 13 df,   p=<2e-16
# Wald test            = 210  on 13 df,   p=<2e-16
# Score (logrank) test = 237.9  on 13 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g3.new_allele_counts.txt n=2 groups=1,2,3 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 1.372033e-08
# 2:             h3 3.767774e-07

# reduction
# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g2
#  reduced = rs74674490_G=0,rs72930631_C=0,rs7116054_T=0,rs17149775_G=0,rs78033785_T=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs11228565_A=0,rs7931342_G=0,rs7119988_A=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs28378931_G=0,rs12796465_G=0,rs4275647_T=1

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g3
#  reduced = rs149949063_G=0,rs72930627_A=0,rs3892895_G=1,rs7116054_T=0,rs67039008_A=0,rs17149775_G=0,rs72932540_G=0,rs74342245_A=0,rs35435383_A=0,rs10896445_C=1,rs10896449_G=1,rs7119988_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g4
#  reduced = rs74674490_G=0,rs72930631_C=0,rs74897859_T=0,rs17308715_T=0,rs11228530_C=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10896445_C=1,rs11228565_A=0,rs10896449_G=1,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs56103266_C=0,rs7103126_C=0,rs10896461_G=0,rs72932105_T=0,rs7481709_C=1,rs117186144_T=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs74674490_G=0,rs72930627_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g5
#  reduced = rs896973_T=0,rs74674490_G=0,rs3892895_G=0,rs17308715_T=0,rs17149775_G=0,rs61881109_A=0,rs7119988_A=0,rs12274095_A=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs4275647_T=1,rs11263641_C=1

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs7116054_T=0,rs17149775_G=0,rs78033785_T=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs11228565_A=0,rs7931342_G=0,rs7119988_A=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs28378931_G=0,rs12796465_G=0,rs4275647_T=1:rs149949063_G=0,rs72930627_A=0,rs3892895_G=1,rs7116054_T=0,rs67039008_A=0,rs17149775_G=0,rs72932540_G=0,rs74342245_A=0,rs35435383_A=0,rs10896445_C=1,rs10896449_G=1,rs7119988_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0:rs74674490_G=0,rs72930631_C=0,rs74897859_T=0,rs17308715_T=0,rs11228530_C=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10896445_C=1,rs11228565_A=0,rs10896449_G=1,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs56103266_C=0,rs7103126_C=0,rs10896461_G=0,rs72932105_T=0,rs7481709_C=1,rs117186144_T=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0:rs896973_T=0,rs74674490_G=0,rs3892895_G=0,rs17308715_T=0,rs17149775_G=0,rs61881109_A=0,rs7119988_A=0,rs12274095_A=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs4275647_T=1,rs11263641_C=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts

# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g5.reduced.new_allele_counts.txt n=4 groups=1,2,3,4,5 threshold=0.05 n_covs=10

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs7116054_T=0,rs17149775_G=0,rs78033785_T=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs11228565_A=0,rs7931342_G=0,rs7119988_A=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs28378931_G=0,rs12796465_G=0,rs4275647_T=1:rs149949063_G=0,rs72930627_A=0,rs3892895_G=1,rs7116054_T=0,rs67039008_A=0,rs17149775_G=0,rs72932540_G=0,rs74342245_A=0,rs35435383_A=0,rs10896445_C=1,rs10896449_G=1,rs7119988_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/g2-g3.reduced.new_allele_counts.txt groups=1,2,3 verbose=1 n=2 n_covs=10
# [1] "X000" "X100" "X101" "X110"
# [1] "DT[,h0:=X000]"
# [1] "DT[,h1.3:=X100+X101]"
# [1] "DT[,h1:=X100]"
# [1] "DT[,h2:=X110]"
# [1] "DT[,h3:=X101]"
#
#    affected  h1.3    h1  h2 h3
# 1:        0 32477 32436 109 41
# 2:        1  2072  2056  28 16
#
#    affected       h1.3         h1           h2           h3
# 1:        0 0.09439726 0.09427809 0.0003168181 0.0001191701
# 2:        1 0.11497059 0.11408279 0.0015536566 0.0008878038
#
#     h1.3    h1  h2 h3
# 1: 34549 34492 137 57
#
#         h1.3         h1          h2          h3
# 1: 0.0954213 0.09526387 0.000378382 0.000157429
#
# Surv(age,affected) ~ h1 + h2 + h3 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2125336  1.2368077  0.0233768  9.092  < 2e-16 ***
# h2    1.5223960  4.5831934  0.1893273  8.041 8.91e-16 ***
# h3    1.8217172  6.1824657  0.2503672  7.276 3.43e-13 ***
# pc01 -0.0104812  0.9895736  0.0069204 -1.515  0.12989
# pc02 -0.0189679  0.9812109  0.0071613 -2.649  0.00808 **
# pc03  0.0084801  1.0085162  0.0069063  1.228  0.21949
# pc04  0.0009161  1.0009166  0.0051806  0.177  0.85963
# pc05  0.0006637  1.0006639  0.0022633  0.293  0.76934
# pc06 -0.0034039  0.9966019  0.0065739 -0.518  0.60460
# pc07  0.0081060  1.0081390  0.0059125  1.371  0.17037
# pc08  0.0010295  1.0010300  0.0058856  0.175  0.86115
# pc09 -0.0006585  0.9993417  0.0022974 -0.287  0.77438
# pc10  0.0033204  1.0033259  0.0050903  0.652  0.51421
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2368     0.8085    1.1814    1.2948
# h2      4.5832     0.2182    3.1624    6.6424
# h3      6.1825     0.1617    3.7849   10.0989
# pc01    0.9896     1.0105    0.9762    1.0031
# pc02    0.9812     1.0191    0.9675    0.9951
# pc03    1.0085     0.9916    0.9950    1.0223
# pc04    1.0009     0.9991    0.9908    1.0111
# pc05    1.0007     0.9993    0.9962    1.0051
# pc06    0.9966     1.0034    0.9838    1.0095
# pc07    1.0081     0.9919    0.9965    1.0199
# pc08    1.0010     0.9990    0.9895    1.0126
# pc09    0.9993     1.0007    0.9949    1.0039
# pc10    1.0033     0.9967    0.9934    1.0134
#
# Concordance= 0.496  (se = 0.003 )
# Likelihood ratio test= 163.4  on 13 df,   p=<2e-16
# Wald test            = 210  on 13 df,   p=<2e-16
# Score (logrank) test = 237.9  on 13 df,   p=<2e-16

# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g3.reduced.new_allele_counts.txt n=2 groups=1,2,3 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 1.372033e-08
# 2:             h3 3.767774e-07

# dbGaP replication

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# cases and combined controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv ukbb_bca_controls.indiv > dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt

# combined controls haplotype file
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_controls.indiv dbgap28544_controls.indiv > ukbb_bca_controls+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_controls+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt

# combined PCs file
# awk 'BEGIN{OFS="\t"} FILENAME==ARGV[1]{diag[$1]=1; next} FILENAME==ARGV[2]{diag[$1]=0; next} FILENAME==ARGV[3]{if ($1 in diag) {$14=diag[$1]}; print $0 }' ukbb_bca_cases.indiv ukbb_bca_controls.indiv /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt > ukbb_permuted.drive.no1kg.pcs.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # h1 reduced
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs7116054_T=0,rs17149775_G=0,rs78033785_T=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs11228565_A=0,rs7931342_G=0,rs7119988_A=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs28378931_G=0,rs12796465_G=0,rs4275647_T=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g2 reduced
# LRT p value = 5.576061e-01 on 1 degree(s) of freedom with OR = 1.396916e+00 (8.511676e-01 to 2.292586e+00), frequency = 6.052831e-04 (67) = 6.818787e-04/5.141998e-04 (41/26)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g2 full-length
# LRT p value = 6.628600e-01 on 1 degree(s) of freedom with OR = 1.355946e+00 (7.976714e-01 to 2.304948e+00), frequency = 5.239764e-04 (58) = 5.820915e-04/4.548691e-04 (35/23)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g2 full-length
# LRT p value = 6.848357e-01 on 1 degree(s) of freedom with OR = 1.349371e+00 (7.922605e-01 to 2.298236e+00), frequency = 5.239764e-04 (58) = 5.820915e-04/4.548691e-04 (35/23)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, DRIVE expected cell counts
# Expected cell counts: a = 31.505655, b = 26.494345, c = 60096.494345, d = 50537.505655

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, UKBB expected cell counts
# Expected cell counts: a = 6.819200, b = 130.180800, c = 18015.180800, d = 343915.819200

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.35 "" 1 # g2 full-length, DRIVE power
# Power to detect OR = 1.35:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 35 -n 60128 -y 23 -m 50564 -o 1.35 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.565345e-07
# OR = 1.350000e+00 (Observed 1.280009e+00, p = 4.290891e-01), power = 2.040687e-01 (1.909000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.35 "" 1 # g2 full-length, UKBB power
# Power to detect OR = 1.35:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 28 -n 18022 -y 109 -m 344046 -o 1.35 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.301872e-07
# OR = 1.350000e+00 (Observed 4.915985e+00, p = 1.733864e-10), power = 1.268699e-01 (1.293000e-01)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies 0.000316818 0.000454869:
# python /home/wletsou/scripts/controls_frequency.py -x1 109 -n1 344046 -x2 23 -n2 50564 -pooled
# p = 1.129457E-01
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 109 -n1 344046 -x2 23 -n2 50564
# p = 1.176338E-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukbb_permuted.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g2 full-length, combined
# LRT p value = 9.230194e-01 on 1 degree(s) of freedom with OR = 1.207149e+00 (7.786072e-01 to 1.871559e+00), frequency = 3.672444e-04 (167) = 5.820915e-04/3.345075e-04 (35/132)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, combined expected cell counts
# Expected cell counts: a = 22.081673, b = 144.918327, c = 60105.918327, d = 394465.081673

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.35 "" 1 # g2 full-length, combined power
# Power to detect OR = 1.35:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 35 -n 60128 -y 132 -m 394610 -o 1.35 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.835696e-07
# OR = 1.350000e+00 (Observed 1.740998e+00, p = 5.686639e-03), power = 2.961877e-01 (2.822000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs149949063_G=0,rs72930627_A=0,rs3892895_G=1,rs7116054_T=0,rs67039008_A=0,rs17149775_G=0,rs72932540_G=0,rs74342245_A=0,rs35435383_A=0,rs10896445_C=1,rs10896449_G=1,rs7119988_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g3 reduced
# LRT p value = 9.452483e-01 on 1 degree(s) of freedom with OR = 1.223160e+00 (8.139240e-01 to 1.838158e+00), frequency = 8.763054e-04 (97) = 9.479776e-04/7.910767e-04 (57/40)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g3 full-length
# LRT p value = 9.452483e-01 on 1 degree(s) of freedom with OR = 1.223160e+00 (8.139240e-01 to 1.838158e+00), frequency = 8.763054e-04 (97) = 9.479776e-04/7.910767e-04 (57/40)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g3 full-length
# LRT p value = 9.323801e-01 on 1 degree(s) of freedom with OR = 1.230751e+00 (8.181804e-01 to 1.851361e+00), frequency = 8.763054e-04 (97) = 9.479776e-04/7.910767e-04 (57/40)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g3, DRIVE expected cell counts
# Expected cell counts: a = 52.690493, b = 44.309507, c = 60075.309507, d = 50519.690493

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g3, UKBB expected cell counts
# Expected cell counts: a = 2.837185, b = 54.162815, c = 18019.162815, d = 343991.837185

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.22 "" 1 # g3 full-length, DRIVE power
# Power to detect OR = 1.22:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 57 -n 60128 -y 40 -m 50564 -o 1.22 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.545284e-06
# OR = 1.220000e+00 (Observed 1.198711e+00, p = 4.150892e-01), power = 1.620531e-01 (1.525000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.22 "" 1 # g3 full-length, UKBB power
# Power to detect OR = 1.22:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 16 -n 18022 -y 41 -m 344046 -o 1.22 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 1.053087e-07
# OR = 1.220000e+00 (Observed 7.462014e+00, p = 1.147167e-08), power = 6.122572e-02 (6.400000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g3 full-length, controls p-value
# Test difference in frequencies 0.00011917 0.000791077:
# python /home/wletsou/scripts/controls_frequency.py -x1 41 -n1 344046 -x2 40 -n2 50564 -pooled
# p = 7.004985E-23
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 41 -n1 344046 -x2 40 -n2 50564
# p = 1.805822E-15

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukbb_permuted.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g3 full-length, combined
# LRT p value = 6.559075e-04 on 1 degree(s) of freedom with OR = 2.447828e+00 (1.625461e+00 to 3.686255e+00), frequency = 3.034714e-04 (138) = 9.479776e-04/2.052660e-04 (57/81)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g3, combined expected cell counts
# Expected cell counts: a = 18.247131, b = 119.752869, c = 60109.752869, d = 394490.247131

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.22 "" 1 # g3 full-length, combined power
# Power to detect OR = 1.22:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 57 -n 60128 -y 81 -m 394610 -o 1.22 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 3.102973e-07
# OR = 1.220000e+00 (Observed 4.625344e+00, p = 3.059496e-16), power = 1.091762e-01 (1.153000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs74897859_T=0,rs17308715_T=0,rs11228530_C=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10896445_C=1,rs11228565_A=0,rs10896449_G=1,rs35637432_A=0,rs34737133_T=0,rs78656034_T=0,rs56103266_C=0,rs7103126_C=0,rs10896461_G=0,rs72932105_T=0,rs7481709_C=1,rs117186144_T=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g4 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g4 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs896973_T=0,rs74674490_G=0,rs3892895_G=0,rs17308715_T=0,rs17149775_G=0,rs61881109_A=0,rs7119988_A=0,rs12274095_A=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs4275647_T=1,rs11263641_C=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g5 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs74674490_G=0,rs72930627_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1 /home/wletsou/scripts # g5 full-length

# controls frequency difference

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=0,rs10896449_G=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 109 -n1 344046 -x2 23 -n2 50564 -pooled
# p = 1.129457E-01

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs74674490_G=0,rs72930631_C=0,rs7116054_T=0,rs17149775_G=0,rs78033785_T=0,rs4495899_G=0,rs117694794_T=0,rs78208050_G=0,rs11228565_A=0,rs7931342_G=0,rs7119988_A=0,rs116951063_T=0,rs11825015_T=0,rs78656034_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs28378931_G=0,rs12796465_G=0,rs4275647_T=1,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 109 -n1 344046 -x2 26 -n2 50564 -pooled
# p = 2.502558E-02

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g3 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 41 -n1 344046 -x2 40 -n2 50564 -pooled
# p = 7.004985E-23

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.1/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs149949063_G=0,rs72930627_A=0,rs3892895_G=1,rs7116054_T=0,rs67039008_A=0,rs17149775_G=0,rs72932540_G=0,rs74342245_A=0,rs35435383_A=0,rs10896445_C=1,rs10896449_G=1,rs7119988_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g3 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 41 -n1 344046 -x2 40 -n2 50564 -pooled
# p = 7.004985E-23

# permutation analysis of h1-carriers
# mkdir UKBB_chr11.34/phase2.2
# cd UKBB_chr11.34
# cp dbgap28544_cases.indiv phase2.2/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv phase2.2/dbgap28544_controls.indiv
# cd phase2.2

# mkdir h1.full-length
# cd h1.full-length

# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200117 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt"

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.68850000-69231641 -oo ukbb_haplotype_extract3.chr11.68850000-69231641.out -eo ukbb_haplotype_extract3.chr11.68850000-69231641.err -R "rusage[mem=20000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv,dbgap28544_cases.indiv,dbgap28544_controls.indiv \"CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt\" \"/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info\" 11 68850000,69231641 \"/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/h1.full-length /home/wletsou/scripts"

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" h1 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/h1.full-length /home/wletsou/scripts
# LRT p value = 1.288629e-21 on 1 degree(s) of freedom with HR = 1.255822e+00 (1.200090e+00 to 1.314142e+00), frequency = 9.579968e-02 (34686) = 1.165242e-01/9.471408e-02 (2100/32586)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/h1.full-length /home/wletsou/scripts
# LRT p value = 4.618525e-06 on 1 degree(s) of freedom with HR = 5.447339e+00 (3.282276e+00 to 9.040527e+00), frequency = 1.574290e-04 (57) = 8.323161e-04/1.220767e-04 (15/42)

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 4.618525e-06

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/h1.full-length /home/wletsou/scripts # h1 full-length
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/h1.full-length /home/wletsou/scripts # g2 full-length
# LRT p value = 6.722192e-01 on 1 degree(s) of freedom with OR = 1.049310e+00 (5.512127e-01 to 1.997508e+00), frequency = 3.432949e-04 (38) = 3.492549e-04/3.362076e-04 (21/17)

# cd .. # phase2.2

# get h1 and list of SNPs in upstream region
# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.chr11.68850000-69231641.txt

# check that SNPs have good "imputation" quality
# awk 'NR==FNR{snp[$1]; next} ($8 in snp && $15==1){print $8}' CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info > CCND1_TAD_snps.chr11.68850000-69231641.tmp
# test -f CCND1_TAD_snps.chr11.68850000-69231641.tmp && mv CCND1_TAD_snps.chr11.68850000-69231641.tmp CCND1_TAD_snps.chr11.68850000-69231641.txt

# vcf files of region (dbGaP only, UKBB exists)

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200117 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# first round of overlaps (of h1-carrying chromosomes among cases)
# bsub -P SJLIFE -J ukbb_bca_overlap.chr11.68850000-69231641 -oo ukbb_bca_overlap.chr11.68850000-69231641.out -eo ukbb_bca_overlap.chr11.68850000-69231641.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_submission13.sh ukbb_bca_cases,ukbb_bca_controls,dbgap28544_cases,dbgap28544_controls 11 68850000,69231641 "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 0.0001 \"\" \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts"

# set a threshold for remaining overlaps
# mv Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# select top-28 non-redundant patterns
# awk 'BEGIN{OFS="\t"} NR==FNR{count[$2]=$1; next} ($1 in count){print count[$1],$1}' Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt <(awk '($5+0<5e-4){print $0}' Pattern_differences.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.p_vals.txt | awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=n; seen[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=$0} } END{for (i in seen) {print seen[i]} }' | sort -gk5 | awk 'NR<=28{print $1}') > Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# Begin iterations:
# bsub -P SJLIFE -J pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/pattern_overlap_iterate3.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.subset.txt 11 68850000,69231641 100 50 2 2,j \"\" \"ukbb_bca_cases\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts"

# sh /home/wletsou/scripts/ukbb_pattern_count_summary.sh ukbb_bca_cases 11 68850000,69231641 2,j

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# forward selection
# translated in parallel, p <
# test -f fisher_exact.ukbb_bca_cases.Results.txt && rm fisher_exact.ukbb_bca_cases.Results.txt; touch fisher_exact.ukbb_bca_cases.Results.txt; for file in fisher_exact.ukbb_bca_cases.Iteration*.txt; do awk '($6+0<1e-2){print $0}' $file >> fisher_exact.ukbb_bca_cases.Results.txt; done;

# remove longer patterns with the same frequency, OR, and p-value as a shorter pattern
# awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=n; seen[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=$0} }  END{for (i in seen) {print seen[i]} }' fisher_exact.ukbb_bca_cases.Results.txt > fisher_exact.ukbb_bca_cases.Results.tmp; test -f fisher_exact.ukbb_bca_cases.Results.tmp && mv fisher_exact.ukbb_bca_cases.Results.tmp fisher_exact.ukbb_bca_cases.Results.txt

# bsub -P SJLIFE -J ukbb_haplotype_translate2_sub -oo ukbb_haplotype_translate2_sub.out -eo ukbb_haplotype_translate2_sub.err -R "rusage[mem=256]" -q standard "sh /home/wletsou/scripts/ukbb_haplotype_translate2_sub.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt fisher_exact.ukbb_bca_cases.Results.txt 50"

# bsub -P SJLIFE -J ukbb_haplotype_model9_sub -oo ukbb_haplotype_model9_sub.out -eo ukbb_haplotype_model9_sub.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_sub.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt fisher_exact.ukbb_bca_cases.Results.translated.txt 1 \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" 1 11 68850000,69231641 50 \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_model9_iterate -oo ukbb_haplotype_model9_iterate.out -eo ukbb_haplotype_model9_iterate.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_iterate.sh allele_counts.txt ukb.bca.pheno.txt 1 1 0.01 Significant_patterns.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts"

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<0.01 && $3 > 1){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs11263638_A=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=1,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=1,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs11603814_G=0,rs72932105_T=0,rs115223540_T=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs12418948_T=1,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g10 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g10.new_allele_counts.txt n=9 groups=1,2,3,4,5,6,7,8,9,10 threshold=0.05 n_covs=10

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<1e-5){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/g2-g2.new_allele_counts.txt groups=1,2 verbose=1 n=1 n_covs=10
# [1] "X00" "X10" "X11"
# [1] "DT[,h0:=X00]"
# [1] "DT[,h1.2:=X10+X11]"
# [1] "DT[,h1:=X10]"
# [1] "DT[,h2:=X11]"
#
#    affected  h1.2    h1 h2
# 1:        0 32586 32544 42
# 2:        1  2100  2085 15
#
#    affected       h1.2        h1           h2
# 1:        0 0.09471408 0.0945920 0.0001220767
# 2:        1 0.11652425 0.1156919 0.0008323161
#
#     h1.2    h1 h2
# 1: 34686 34629 57
#
#          h1.2         h1          h2
# 1: 0.09579968 0.09564226 0.000157429
#
# Surv(age,affected) ~ h1 + h2 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2221043  1.2487016  0.0232353  9.559  < 2e-16 ***
# h2    1.6951273  5.4473394  0.2584691  6.558 5.44e-11 ***
# pc01  0.0020643  1.0020664  0.0069164  0.298    0.765
# pc02 -0.0098657  0.9901828  0.0071609 -1.378    0.168
# pc03  0.0038204  1.0038277  0.0069079  0.553    0.580
# pc04  0.0034863  1.0034924  0.0051830  0.673    0.501
# pc05  0.0007318  1.0007321  0.0022608  0.324    0.746
# pc06  0.0032934  1.0032988  0.0065751  0.501    0.616
# pc07  0.0057809  1.0057977  0.0059085  0.978    0.328
# pc08  0.0071239  1.0071494  0.0058775  1.212    0.225
# pc09 -0.0000638  0.9999362  0.0023084 -0.028    0.978
# pc10  0.0042031  1.0042120  0.0050936  0.825    0.409
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2487     0.8008    1.1931     1.307
# h2      5.4473     0.1836    3.2823     9.041
# pc01    1.0021     0.9979    0.9886     1.016
# pc02    0.9902     1.0099    0.9764     1.004
# pc03    1.0038     0.9962    0.9903     1.018
# pc04    1.0035     0.9965    0.9934     1.014
# pc05    1.0007     0.9993    0.9963     1.005
# pc06    1.0033     0.9967    0.9905     1.016
# pc07    1.0058     0.9942    0.9942     1.018
# pc08    1.0071     0.9929    0.9956     1.019
# pc09    0.9999     1.0001    0.9954     1.004
# pc10    1.0042     0.9958    0.9942     1.014
#
# Concordance= 0.495  (se = 0.003 )
# Likelihood ratio test= 120.7  on 12 df,   p=<2e-16
# Wald test            = 142  on 12 df,   p=<2e-16
# Score (logrank) test = 153.4  on 12 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 4.618525e-06

# reduction
# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g2
#  reduced = rs3829241_A=1,rs67039008_A=0,rs35435383_A=0,rs7931342_G=1,rs7119988_A=1,rs10896461_G=0,rs7124547_T=0,rs11600497_A=0,rs4275647_T=1,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs11263638_A=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g3
#  reduced = rs1123665_G=1,rs11228502_C=0,rs12577213_A=0,rs7116054_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs11228599_T=0,rs116951063_T=0,rs117131950_A=0,rs7103126_C=0,rs11601693_A=0,rs12224376_A=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs4275647_T=0,rs11263638_A=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g4
#  reduced = rs72930627_A=0,rs7116054_T=0,rs74897859_T=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs10896445_C=1,rs11825015_T=0,rs7103126_C=1,rs72932105_T=0,rs7481709_C=1,rs28378931_G=0,rs4275647_T=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g5
#  reduced = rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs11228530_C=0,rs11228565_A=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs7124547_T=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs11600497_A=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=1,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=1,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g6
#  reduced = rs2376558_C=1,rs3829241_A=0,rs67039008_A=1,rs11228530_C=1,rs4495899_G=0,rs61881109_A=0,rs11825015_T=0,rs7103126_C=0,rs12789955_G=0,rs79487139_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g7
#  reduced = rs896973_T=1,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs10896445_C=1,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs4275647_T=0,rs61882193_G=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g8
#  reduced = rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs3892895_G=0,rs67039008_A=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs61881109_A=0,rs7119988_A=0,rs74551015_A=0,rs11603814_G=0,rs12789955_G=0,rs4275647_T=0,rs11263641_C=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs11603814_G=0,rs72932105_T=0,rs115223540_T=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g9
#  reduced = rs72930631_C=0,rs12418948_T=0,rs4495899_G=1,rs7119988_A=0,rs116951063_T=0,rs7124547_T=1,rs11603814_G=0,rs11600497_A=0,rs4275647_T=1,rs11263641_C=1

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs12418948_T=1,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g10
#  reduced = rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs67039008_A=0,rs12418948_T=1,rs11228565_A=0,rs7931342_G=1,rs56103266_C=0,rs73512137_T=0,rs7124547_T=1,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs67039008_A=0,rs35435383_A=0,rs7931342_G=1,rs7119988_A=1,rs10896461_G=0,rs7124547_T=0,rs11600497_A=0,rs4275647_T=1,rs76855139_T=0:rs1123665_G=1,rs11228502_C=0,rs12577213_A=0,rs7116054_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs11228599_T=0,rs116951063_T=0,rs117131950_A=0,rs7103126_C=0,rs11601693_A=0,rs12224376_A=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs4275647_T=0,rs11263638_A=0:rs72930627_A=0,rs7116054_T=0,rs74897859_T=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs10896445_C=1,rs11825015_T=0,rs7103126_C=1,rs72932105_T=0,rs7481709_C=1,rs28378931_G=0,rs4275647_T=0,rs76855139_T=0:rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs11228530_C=0,rs11228565_A=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs7124547_T=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs11600497_A=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0:rs2376558_C=1,rs3829241_A=0,rs67039008_A=1,rs11228530_C=1,rs4495899_G=0,rs61881109_A=0,rs11825015_T=0,rs7103126_C=0,rs12789955_G=0,rs79487139_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0:rs896973_T=1,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs10896445_C=1,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs4275647_T=0,rs61882193_G=0:rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs3892895_G=0,rs67039008_A=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs61881109_A=0,rs7119988_A=0,rs74551015_A=0,rs11603814_G=0,rs12789955_G=0,rs4275647_T=0,rs11263641_C=0:rs72930631_C=0,rs12418948_T=0,rs4495899_G=1,rs7119988_A=0,rs116951063_T=0,rs7124547_T=1,rs11603814_G=0,rs11600497_A=0,rs4275647_T=1,rs11263641_C=1:rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs67039008_A=0,rs12418948_T=1,rs11228565_A=0,rs7931342_G=1,rs56103266_C=0,rs73512137_T=0,rs7124547_T=1,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g10.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g10.reduced.new_allele_counts.txt n=9 groups=1,2,3,4,5,6,7,8,9,10 threshold=0.05 n_covs=10

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs67039008_A=0,rs35435383_A=0,rs7931342_G=1,rs7119988_A=1,rs10896461_G=0,rs7124547_T=0,rs11600497_A=0,rs4275647_T=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/g2-g2.reduced.new_allele_counts.txt groups=1,2 verbose=1 n=1 n_covs=10
# [1] "X00" "X10" "X11"
# [1] "DT[,h0:=X00]"
# [1] "DT[,h1.2:=X10+X11]"
# [1] "DT[,h1:=X10]"
# [1] "DT[,h2:=X11]"
#
#    affected  h1.2    h1 h2
# 1:        0 32586 32544 42
# 2:        1  2100  2085 15
#
#    affected       h1.2        h1           h2
# 1:        0 0.09471408 0.0945920 0.0001220767
# 2:        1 0.11652425 0.1156919 0.0008323161
#
#     h1.2    h1 h2
# 1: 34686 34629 57
#
#          h1.2         h1          h2
# 1: 0.09579968 0.09564226 0.000157429
#
# Surv(age,affected) ~ h1 + h2 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2221043  1.2487016  0.0232353  9.559  < 2e-16 ***
# h2    1.6951273  5.4473394  0.2584691  6.558 5.44e-11 ***
# pc01  0.0020643  1.0020664  0.0069164  0.298    0.765
# pc02 -0.0098657  0.9901828  0.0071609 -1.378    0.168
# pc03  0.0038204  1.0038277  0.0069079  0.553    0.580
# pc04  0.0034863  1.0034924  0.0051830  0.673    0.501
# pc05  0.0007318  1.0007321  0.0022608  0.324    0.746
# pc06  0.0032934  1.0032988  0.0065751  0.501    0.616
# pc07  0.0057809  1.0057977  0.0059085  0.978    0.328
# pc08  0.0071239  1.0071494  0.0058775  1.212    0.225
# pc09 -0.0000638  0.9999362  0.0023084 -0.028    0.978
# pc10  0.0042031  1.0042120  0.0050936  0.825    0.409
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2487     0.8008    1.1931     1.307
# h2      5.4473     0.1836    3.2823     9.041
# pc01    1.0021     0.9979    0.9886     1.016
# pc02    0.9902     1.0099    0.9764     1.004
# pc03    1.0038     0.9962    0.9903     1.018
# pc04    1.0035     0.9965    0.9934     1.014
# pc05    1.0007     0.9993    0.9963     1.005
# pc06    1.0033     0.9967    0.9905     1.016
# pc07    1.0058     0.9942    0.9942     1.018
# pc08    1.0071     0.9929    0.9956     1.019
# pc09    0.9999     1.0001    0.9954     1.004
# pc10    1.0042     0.9958    0.9942     1.014
#
# Concordance= 0.495  (se = 0.003 )
# Likelihood ratio test= 120.7  on 12 df,   p=<2e-16
# Wald test            = 142  on 12 df,   p=<2e-16
# Score (logrank) test = 153.4  on 12 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.reduced.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 4.618525e-06

# dbGaP replication

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# cases and combined controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv ukbb_bca_controls.indiv > dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt

# combined controls haplotype file
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_controls.indiv dbgap28544_controls.indiv > ukbb_bca_controls+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_controls+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt

# combined PCs file
# awk 'BEGIN{OFS="\t"} FILENAME==ARGV[1]{diag[$1]=1; next} FILENAME==ARGV[2]{diag[$1]=0; next} FILENAME==ARGV[3]{if ($1 in diag) {$14=diag[$1]}; print $0 }' ukbb_bca_cases.indiv ukbb_bca_controls.indiv /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt > ukbb_permuted.drive.no1kg.pcs.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # h1 reduced
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=1,rs67039008_A=0,rs35435383_A=0,rs7931342_G=1,rs7119988_A=1,rs10896461_G=0,rs7124547_T=0,rs11600497_A=0,rs4275647_T=1,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g2 reduced
# LRT p value = 8.817402e-01 on 1 degree(s) of freedom with OR = 1.151401e+00 (6.256710e-01 to 2.118884e+00), frequency = 3.884653e-04 (43) = 4.157797e-04/3.559845e-04 (25/18)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g2 full-length
# LRT p value = 6.722192e-01 on 1 degree(s) of freedom with OR = 1.049310e+00 (5.512127e-01 to 1.997508e+00), frequency = 3.432949e-04 (38) = 3.492549e-04/3.362076e-04 (21/17)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g2 full-length
# LRT p value = 7.359554e-01 on 1 degree(s) of freedom with OR = 1.082208e+00 (5.677035e-01 to 2.063005e+00), frequency = 3.432949e-04 (38) = 3.492549e-04/3.362076e-04 (21/17)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, DRIVE expected cell counts
# Expected cell counts: a = 20.641636, b = 17.358364, c = 60107.358364, d = 50546.641636

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, UKBB expected cell counts
# Expected cell counts: a = 2.837185, b = 54.162815, c = 18019.162815, d = 343991.837185

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # g2 full-length, DRIVE power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 17 -m 50564 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 2.356253e-07
# OR = 1.080000e+00 (Observed 1.038841e+00, p = 1.000000e+00), power = 5.650644e-02 (4.480000e-02)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # g2 full-length, UKBB power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 15 -n 18022 -y 42 -m 344046 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 9.716367e-08
# OR = 1.080000e+00 (Observed 6.826299e+00, p = 8.459532e-08), power = 5.152688e-02 (3.650000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies 0.000122077 0.000336208:
# python /home/wletsou/scripts/controls_frequency.py -x1 42 -n1 344046 -x2 17 -n2 50564 -pooled
# p = 2.358279E-04
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 42 -n1 344046 -x2 17 -n2 50564
# p = 1.191145E-03

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukbb_permuted.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g2 full-length, combined
# LRT p value = 2.059056e-01 on 1 degree(s) of freedom with OR = 1.730807e+00 (9.706642e-01 to 3.086230e+00), frequency = 1.759255e-04 (80) = 3.492549e-04/1.495147e-04 (21/59)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, combined expected cell counts
# Expected cell counts: a = 10.578047, b = 69.421953, c = 60117.421953, d = 394540.578047

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.08 "" 1 # g2 full-length, combined power
# Power to detect OR = 1.08:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 21 -n 60128 -y 59 -m 394610 -o 1.08 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 7.102094e-08
# OR = 1.080000e+00 (Observed 2.336784e+00, p = 1.519561e-03), power = 5.567439e-02 (5.500000e-02)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs1123665_G=1,rs11228502_C=0,rs12577213_A=0,rs7116054_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs11228599_T=0,rs116951063_T=0,rs117131950_A=0,rs7103126_C=0,rs11601693_A=0,rs12224376_A=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs4275647_T=0,rs11263638_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g3 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs11263638_A=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g3 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs72930627_A=0,rs7116054_T=0,rs74897859_T=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs10896445_C=1,rs11825015_T=0,rs7103126_C=1,rs72932105_T=0,rs7481709_C=1,rs28378931_G=0,rs4275647_T=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g4 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g4 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs11228530_C=0,rs11228565_A=0,rs11825015_T=0,rs74551015_A=0,rs56103266_C=0,rs7124547_T=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs11600497_A=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g5 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g5 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs3829241_A=0,rs67039008_A=1,rs11228530_C=1,rs4495899_G=0,rs61881109_A=0,rs11825015_T=0,rs7103126_C=0,rs12789955_G=0,rs79487139_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g6 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=1,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=1,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g6.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g6 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs896973_T=1,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs10896445_C=1,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs4275647_T=0,rs61882193_G=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g7 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g7.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g7 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs3892895_G=0,rs67039008_A=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs61881109_A=0,rs7119988_A=0,rs74551015_A=0,rs11603814_G=0,rs12789955_G=0,rs4275647_T=0,rs11263641_C=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g8.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g8 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=0,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g8.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g8 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs72930631_C=0,rs12418948_T=0,rs4495899_G=1,rs7119988_A=0,rs116951063_T=0,rs7124547_T=1,rs11603814_G=0,rs11600497_A=0,rs4275647_T=1,rs11263641_C=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g9.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g9 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs11603814_G=0,rs72932105_T=0,rs115223540_T=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g9.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g9 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=0,rs72930627_A=0,rs3892895_G=1,rs67039008_A=0,rs12418948_T=1,rs11228565_A=0,rs7931342_G=1,rs56103266_C=0,rs73512137_T=0,rs7124547_T=1,rs79487139_T=0,rs11600497_A=0,rs61882193_G=0,rs11263638_A=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g10.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g10 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs12418948_T=1,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7130881_G=0,rs7119988_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs142581206_T=0,rs73512137_T=0,rs11601693_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g10.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2 /home/wletsou/scripts # g10 full-length

# sh /home/wletsou/scripts/ukbb_haplotype_haplotype_LD2.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs7124547_T=1,rs11603814_G=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs72930627_A=0,rs72930631_C=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs75590802_A=0,rs7937094_T=0,rs4930672_A=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs78919175_T=0,rs72932105_T=0,rs7481709_C=1,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs4275647_T=0,rs61882193_G=0,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0"

# controls frequency difference

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=1,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs3829241_A=1,rs74674490_G=0,rs72930627_A=0,rs72930631_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs74897859_T=0,rs17308715_T=0,rs67039008_A=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs72932540_G=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=1,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7931342_G=1,rs10896449_G=1,rs7119988_A=1,rs111762835_A=0,rs4930672_A=0,rs11228599_T=1,rs7940107_A=1,rs72930267_T=1,rs7946255_C=1,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs10896461_G=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 42 -n1 344046 -x2 17 -n2 50564 -pooled
# p = 2.358279E-04

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.2/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs3829241_A=1,rs67039008_A=0,rs35435383_A=0,rs7931342_G=1,rs7119988_A=1,rs10896461_G=0,rs7124547_T=0,rs11600497_A=0,rs4275647_T=1,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 42 -n1 344046 -x2 18 -n2 50564 -pooled
# p = 6.799626E-05

# permutation analysis of h1-carriers
# mkdir UKBB_chr11.34/phase2.3
# cd UKBB_chr11.34
# cp dbgap28544_cases.indiv phase2.3/dbgap28544_cases.indiv
# cp dbgap28544_controls.indiv phase2.3/dbgap28544_controls.indiv
# cd phase2.3

# mkdir h1.full-length
# cd h1.full-length

# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200118 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt"

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) # UKBB samples in dbGaP, if any

# bsub -P SJLIFE -J ukbb_haplotype_extract3.chr11.68850000-69231641 -oo ukbb_haplotype_extract3.chr11.68850000-69231641.out -eo ukbb_haplotype_extract3.chr11.68850000-69231641.err -R "rusage[mem=20000]" -q large_mem "sh /home/wletsou/scripts/ukbb_haplotype_extract3.sh ukbb_bca_cases.indiv,ukbb_bca_controls.indiv,dbgap28544_cases.indiv,dbgap28544_controls.indiv \"CCND1_TAD_snps.h1.full-length.chr11.68850000-69231641.txt\" \"/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info\" 11 68850000,69231641 \"/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2/h1.full-length/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/h1.full-length /home/wletsou/scripts"

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" h1 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/h1.full-length /home/wletsou/scripts
# LRT p value = 1.192425e-21 on 1 degree(s) of freedom with HR = 1.256071e+00 (1.200328e+00 to 1.314402e+00), frequency = 9.579968e-02 (34686) = 1.165242e-01/9.471408e-02 (2100/32586)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/h1.full-length /home/wletsou/scripts
# LRT p value = 2.549575e-06 on 1 degree(s) of freedom with HR = 2.423079e+00 (1.887353e+00 to 3.110872e+00), frequency = 1.455528e-03 (527) = 3.440240e-03/1.351563e-03 (62/465)

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.549575e-06

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/h1.full-length /home/wletsou/scripts # h1 full-length
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs2298764_C=0,rs117222887_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/h1.full-length /home/wletsou/scripts # g2 full-length
# LRT p value = 5.721121e-01 on 1 degree(s) of freedom with OR = 1.107253e+00 (8.218350e-01 to 1.491794e+00), frequency = 1.617100e-03 (179) = 1.679750e-03/1.542599e-03 (101/78)

# cd .. # phase2.3

# get h1 and list of SNPs in upstream region
# HAPLOTYPE_SNPS=$(echo "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" | sed 's/_[A-Z]=[0-9]//g') # snps in h1, no alleles

# awk 'BEGIN{OFS="\t"} ( ($2>=68850000 && $2<69231642) || "'$HAPLOTYPE_SNPS'" ~ $3){print $3}' /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/ukbb_genotyped_snps/ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69500000.haplotypes.vcf > CCND1_TAD_snps.chr11.68850000-69231641.txt

# check that SNPs have good "imputation" quality
# awk 'NR==FNR{snp[$1]; next} ($8 in snp && $15==1){print $8}' CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info > CCND1_TAD_snps.chr11.68850000-69231641.tmp
# test -f CCND1_TAD_snps.chr11.68850000-69231641.tmp && mv CCND1_TAD_snps.chr11.68850000-69231641.tmp CCND1_TAD_snps.chr11.68850000-69231641.txt

# vcf files of region (dbGaP only, UKBB exists)

# bsub -P SJLIFE -J dbgap_haplotype_merge.chr11.68850000-69231641 -oo dbgap_haplotype_merge.chr11.68850000-69231641.out -eo dbgap_haplotype_merge.chr11.68850000-69231641.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/dbgap_haplotype_merge.sh dbgap28544_cases,dbgap28544_controls "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt" "/research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/chr11.qced.info" CCND1_TAD_snps.chr11.68850000-69231641.txt 11 68850000,69231641 /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/topmedr2/cleaned/vcfs/dbgap28544.topmedr2.cleaned.hg38.chr11.vcf.gz"

# permute case- and control-h1-carriers
# bsub -P SJLIFE -J ukbb_haplotype_permute -oo ukbb_haplotype_permute.out -eo ukbb_haplotype_permute.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_permute.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/hap.gds/ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.69231642-69431642.txt rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 20200118 ukbb_bca_cases,ukbb_bca_controls ukb.bca.pheno.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts"

# check that there are no overlapping samples
# module load bcftools/1.10.2

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) | wc -l # dbGaP samples in dbGaP

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) | wc -l # dbGaP samples in UKBB, if any

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) | wc -l # UKBB samples in UKBB

# awk 'NR==FNR{seen[$1]; next} ($1 in seen){print $0}' <(bcftools query -l /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz) <(bcftools query -l dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz) | wc -l # UKBB samples in dbGaP, if any

# first round of overlaps (of h1-carrying chromosomes among cases)
# bsub -P SJLIFE -J ukbb_bca_overlap.chr11.68850000-69231641 -oo ukbb_bca_overlap.chr11.68850000-69231641.out -eo ukbb_bca_overlap.chr11.68850000-69231641.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_submission13.sh ukbb_bca_cases,ukbb_bca_controls,dbgap28544_cases,dbgap28544_controls 11 68850000,69231641 "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" CCND1_TAD_snps.chr11.68850000-69231641.txt /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/ukbb.topmed.hg19_chr11.68850000-69231641.hg38.vcf.gz,dbgap28544_cases+dbgap28544_controls.hg19_chr11.68850000-69231641.hg38.vcf.gz /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/ukb.bca/topmed/chr11/chr11.qced.anno.info 0.0001 \"\" \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts"

# set a threshold for remaining overlaps
# mv Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# select top-28 non-redundant patterns
# awk 'BEGIN{OFS="\t"} NR==FNR{count[$2]=$1; next} ($1 in count){print count[$1],$1}' Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt <(awk '($5+0<5e-3){print $0}' Pattern_differences.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.p_vals.txt | awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=n; seen[sprintf("%s\t%s\t%s\t%s",$2,$3,$4,$5)]=$0} } END{for (i in seen) {print seen[i]} }' | sort -gk5 | awk 'NR<=28{print $1}') > Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt Pattern_combined_old.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# mv Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.tmp Pattern_combined.Iteration000.ukbb_bca_cases.chr11.68850000-69231641_2,j.txt

# Begin iterations:
# bsub -P SJLIFE -J pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641 -oo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.out -eo /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/pattern_overlap_iterate3.ukbb_bca_cases.chr11.68850000-69231641.err -R "rusage[mem=512]" "sh /home/wletsou/scripts/pattern_overlap_iterate3.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.subset.txt 11 68850000,69231641 100 50 2 2,j \"\" \"ukbb_bca_cases\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts"

# sh /home/wletsou/scripts/ukbb_pattern_count_summary.sh ukbb_bca_cases 11 68850000,69231641 2,j

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_cases.indiv ukbb_bca_controls.indiv > ukbb_bca_cases+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_cases+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt

# forward selection
# translated in parallel, p <
# test -f fisher_exact.ukbb_bca_cases.Results.txt && rm fisher_exact.ukbb_bca_cases.Results.txt; touch fisher_exact.ukbb_bca_cases.Results.txt; for file in fisher_exact.ukbb_bca_cases.Iteration*.txt; do awk '($6+0<1e-2){print $0}' $file >> fisher_exact.ukbb_bca_cases.Results.txt; done;

# remove longer patterns with the same frequency, OR, and p-value as a shorter pattern
# awk 'BEGIN{array[0]} {delete array; n=split($1,array,","); if (n<snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0 || snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]+0==0) {snps[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=n; seen[sprintf("%s\t%s\t%s\t%s",$3,$4,$5,$6)]=$0} }  END{for (i in seen) {print seen[i]} }' fisher_exact.ukbb_bca_cases.Results.txt > fisher_exact.ukbb_bca_cases.Results.tmp; test -f fisher_exact.ukbb_bca_cases.Results.tmp && mv fisher_exact.ukbb_bca_cases.Results.tmp fisher_exact.ukbb_bca_cases.Results.txt

# bsub -P SJLIFE -J ukbb_haplotype_translate2_sub -oo ukbb_haplotype_translate2_sub.out -eo ukbb_haplotype_translate2_sub.err -R "rusage[mem=256]" -q standard "sh /home/wletsou/scripts/ukbb_haplotype_translate2_sub.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.subset.txt fisher_exact.ukbb_bca_cases.Results.txt 50"

# bsub -P SJLIFE -J ukbb_haplotype_model9_sub -oo ukbb_haplotype_model9_sub.out -eo ukbb_haplotype_model9_sub.err -R "rusage[mem=256]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_sub.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt fisher_exact.ukbb_bca_cases.Results.translated.txt 1 \"rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0\" 1 11 68850000,69231641 50 \"\" \"\" /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts"

# bsub -P SJLIFE -J ukbb_haplotype_model9_iterate -oo ukbb_haplotype_model9_iterate.out -eo ukbb_haplotype_model9_iterate.err -R "rusage[mem=1000]" "sh /home/wletsou/scripts/ukbb_haplotype_model9_iterate.sh allele_counts.txt ukb.bca.pheno.txt 1 1 0.01 Significant_patterns.txt /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts"

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<0.01 && $3 > 1){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=1,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0:rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0:rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs115223540_T=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g7 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g7.new_allele_counts.txt n=6 groups=1,2,3,4,5,6,7 threshold=0.05 n_covs=10

# HAPLOTYPE_LIST=$(awk '(NR>1 && $6+0<1e-5){printf "%s%s",(found>0?":":""),$2; found+=1} END{printf "\n"}' Significant_patterns.txt)

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2 /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/g2-g2.new_allele_counts.txt groups=1,2 verbose=1 n=1 n_covs=10
# [1] "X00" "X10" "X11"
# [1] "DT[,h0:=X00]"
# [1] "DT[,h1.2:=X10+X11]"
# [1] "DT[,h1:=X10]"
# [1] "DT[,h2:=X11]"
#
#    affected  h1.2    h1  h2
# 1:        0 32586 32121 465
# 2:        1  2100  2038  62
#
#    affected       h1.2         h1          h2
# 1:        0 0.09471408 0.09336252 0.001351563
# 2:        1 0.11652425 0.11308401 0.003440240
#
#     h1.2    h1  h2
# 1: 34686 34159 527
#
#          h1.2         h1          h2
# 1: 0.09579968 0.09434416 0.001455528
#
# Surv(age,affected) ~ h1 + h2 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2135279  1.2380381  0.0234695  9.098  < 2e-16 ***
# h2    0.8850391  2.4230792  0.1274840  6.942 3.86e-12 ***
# pc01 -0.0021930  0.9978094  0.0069193 -0.317    0.751
# pc02 -0.0055408  0.9944745  0.0071637 -0.773    0.439
# pc03  0.0029290  1.0029333  0.0069072  0.424    0.672
# pc04  0.0018322  1.0018339  0.0051859  0.353    0.724
# pc05  0.0013503  1.0013512  0.0022629  0.597    0.551
# pc06  0.0050139  1.0050265  0.0065760  0.762    0.446
# pc07  0.0069257  1.0069497  0.0059140  1.171    0.242
# pc08 -0.0002756  0.9997244  0.0058841 -0.047    0.963
# pc09 -0.0016379  0.9983635  0.0022852 -0.717    0.474
# pc10  0.0040884  1.0040968  0.0050918  0.803    0.422
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2380     0.8077    1.1824     1.296
# h2      2.4231     0.4127    1.8874     3.111
# pc01    0.9978     1.0022    0.9844     1.011
# pc02    0.9945     1.0056    0.9806     1.009
# pc03    1.0029     0.9971    0.9894     1.017
# pc04    1.0018     0.9982    0.9917     1.012
# pc05    1.0014     0.9987    0.9969     1.006
# pc06    1.0050     0.9950    0.9922     1.018
# pc07    1.0069     0.9931    0.9953     1.019
# pc08    0.9997     1.0003    0.9883     1.011
# pc09    0.9984     1.0016    0.9939     1.003
# pc10    1.0041     0.9959    0.9941     1.014
#
# Concordance= 0.494  (se = 0.003 )
# Likelihood ratio test= 119.9  on 12 df,   p=<2e-16
# Wald test            = 134.9  on 12 df,   p=<2e-16
# Score (logrank) test = 138.2  on 12 df,   p=<2e-16

# backward selection
# module load R/3.6.1
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.549575e-06

# reduction
# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g2
# reduced = rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=1,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g3
# reduced = rs3892895_G=1,rs7116054_T=0,rs17149775_G=0,rs10896445_C=1,rs11228599_T=0,rs35637432_A=0,rs11825015_T=0,rs117821797_T=0,rs11539762_A=0,rs7124547_T=1,rs12802601_C=0,rs11263638_A=1

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g4
# reduced = rs3829241_A=0,rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs55703863_C=0,rs17149775_G=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs111762835_A=0,rs11228599_T=0,rs35637432_A=0,rs78656034_T=0,rs7103126_C=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs72932198_A=0,rs11263641_C=1

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g5
# reduced = rs1123665_G=0,rs67039008_A=1,rs12275849_C=0,rs7103126_C=1,rs7481709_C=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g6
# reduced = rs74674490_G=0,rs11228502_C=0,rs3892895_G=1,rs7116054_T=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs7103126_C=0,rs11603814_G=1,rs7481709_C=0,rs7102705_G=1,rs11600497_A=0

# sh /home/wletsou/scripts/haplotype_rpart.sh haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs115223540_T=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" 1 # g7
# reduced = rs896973_T=0,rs117694794_T=0,rs61881109_A=0,rs7130881_G=0,rs78656034_T=0,rs7124547_T=0,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs117186144_T=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs11263638_A=0

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0:rs3892895_G=1,rs7116054_T=0,rs17149775_G=0,rs10896445_C=1,rs11228599_T=0,rs35637432_A=0,rs11825015_T=0,rs117821797_T=0,rs11539762_A=0,rs7124547_T=1,rs12802601_C=0,rs11263638_A=1:rs3829241_A=0,rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs55703863_C=0,rs17149775_G=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs111762835_A=0,rs11228599_T=0,rs35637432_A=0,rs78656034_T=0,rs7103126_C=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs72932198_A=0,rs11263641_C=1:rs1123665_G=0,rs67039008_A=1,rs12275849_C=0,rs7103126_C=1,rs7481709_C=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0:rs74674490_G=0,rs11228502_C=0,rs3892895_G=1,rs7116054_T=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs7103126_C=0,rs11603814_G=1,rs7481709_C=0,rs7102705_G=1,rs11600497_A=0:rs896973_T=0,rs117694794_T=0,rs61881109_A=0,rs7130881_G=0,rs78656034_T=0,rs7124547_T=0,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs117186144_T=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs11263638_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts

# backward selection
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g7.reduced.new_allele_counts.txt n=6 groups=1,2,3,4,5,6,7 threshold=0.05 n_covs=10

# sh /home/wletsou/scripts/ukbb_haplotype_model9_count_fit.sh ukb.bca.pheno.txt haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls.chr11.68850000-69231641.txt "rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" g2-g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts
# Rscript /home/wletsou/scripts/ukbb_haplotype_model5.R file=/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/g2-g2.reduced.new_allele_counts.txt groups=1,2 verbose=1 n=1 n_covs=10
# [1] "X00" "X10" "X11"
# [1] "DT[,h0:=X00]"
# [1] "DT[,h1.2:=X10+X11]"
# [1] "DT[,h1:=X10]"
# [1] "DT[,h2:=X11]"
#
#    affected  h1.2    h1  h2
# 1:        0 32586 32119 467
# 2:        1  2100  2038  62
#
#    affected       h1.2        h1          h2
# 1:        0 0.09471408 0.0933567 0.001357377
# 2:        1 0.11652425 0.1130840 0.003440240
#
#     h1.2    h1  h2
# 1: 34686 34157 529
#
#          h1.2         h1          h2
# 1: 0.09579968 0.09433863 0.001461052
#
# Surv(age,affected) ~ h1 + h2 + pc01 + pc02 + pc03 + pc04 + pc05 + pc06 + pc07 + pc08 + pc09 + pc10
# Call:
# coxph(formula = eval(parse(text = Y)), data = X)
#
#   n= 181034, number of events= 9011
#
#            coef  exp(coef)   se(coef)      z Pr(>|z|)
# h1    0.2136019  1.2381296  0.0234694  9.101  < 2e-16 ***
# h2    0.8807932  2.4128127  0.1274841  6.909 4.88e-12 ***
# pc01 -0.0021966  0.9978058  0.0069193 -0.317    0.751
# pc02 -0.0055476  0.9944678  0.0071637 -0.774    0.439
# pc03  0.0029341  1.0029384  0.0069072  0.425    0.671
# pc04  0.0018426  1.0018443  0.0051858  0.355    0.722
# pc05  0.0013493  1.0013502  0.0022629  0.596    0.551
# pc06  0.0050145  1.0050271  0.0065760  0.763    0.446
# pc07  0.0069220  1.0069460  0.0059140  1.170    0.242
# pc08 -0.0002881  0.9997119  0.0058839 -0.049    0.961
# pc09 -0.0016385  0.9983629  0.0022852 -0.717    0.473
# pc10  0.0040796  1.0040880  0.0050917  0.801    0.423
# ---
# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#
#      exp(coef) exp(-coef) lower .95 upper .95
# h1      1.2381     0.8077    1.1825     1.296
# h2      2.4128     0.4145    1.8794     3.098
# pc01    0.9978     1.0022    0.9844     1.011
# pc02    0.9945     1.0056    0.9806     1.009
# pc03    1.0029     0.9971    0.9895     1.017
# pc04    1.0018     0.9982    0.9917     1.012
# pc05    1.0014     0.9987    0.9969     1.006
# pc06    1.0050     0.9950    0.9922     1.018
# pc07    1.0069     0.9931    0.9953     1.019
# pc08    0.9997     1.0003    0.9882     1.011
# pc09    0.9984     1.0016    0.9939     1.003
# pc10    1.0041     0.9959    0.9941     1.014
#
# Concordance= 0.494  (se = 0.003 )
# Likelihood ratio test= 119.7  on 12 df,   p=<2e-16
# Wald test            = 134.5  on 12 df,   p=<2e-16
# Score (logrank) test = 137.7  on 12 df,   p=<2e-16

# backward selection
# Rscript /home/wletsou/scripts/ukbb_backward_selection2.R file=g2-g2.reduced.new_allele_counts.txt n=1 groups=1,2 threshold=0.05 n_covs=10
# remaining_vars         pval
# 1:             h2 2.914031e-06

# dbGaP replication

# combined haplotype file for cases and controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv > dbgap28544_cases+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt

# cases and combined controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv ukbb_bca_controls.indiv > dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt

# combined controls haplotype file
# awk 'BEGIN{OFS="\t"} {print $0}' ukbb_bca_controls.indiv dbgap28544_controls.indiv > ukbb_bca_controls+dbgap28544_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' ukbb_bca_controls+dbgap28544_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt

# combined PCs file
# awk 'BEGIN{OFS="\t"} FILENAME==ARGV[1]{diag[$1]=1; next} FILENAME==ARGV[2]{diag[$1]=0; next} FILENAME==ARGV[3]{if ($1 in diag) {$14=diag[$1]}; print $0 }' ukbb_bca_cases.indiv ukbb_bca_controls.indiv /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/drive4william/flashpcar/ukbb.drive.no1kg.pcs.txt > ukbb_permuted.drive.no1kg.pcs.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "" "" "" "" dbgap28544.h1.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # h1
# LRT p value = 3.109647e-21 on 1 degree(s) of freedom with OR = 1.205913e+00 (1.159833e+00 to 1.253823e+00), frequency = 1.058703e-01 (11719) = 1.135078e-01/9.678823e-02 (6825/4894)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 reduced
# LRT p value = 7.572351e-01 on 1 degree(s) of freedom with OR = 1.151693e+00 (8.583751e-01 to 1.545241e+00), frequency = 1.671304e-03 (185) = 1.762906e-03/1.562376e-03 (106/79)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 full-length
# LRT p value = 5.721121e-01 on 1 degree(s) of freedom with OR = 1.107253e+00 (8.218350e-01 to 1.491794e+00), frequency = 1.617100e-03 (179) = 1.679750e-03/1.542599e-03 (101/78)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/phenotype/dbgap28544.unrls.eur.newPCs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 full-length
# LRT p value = 6.096510e-01 on 1 degree(s) of freedom with OR = 1.119438e+00 (8.305963e-01 to 1.508724e+00), frequency = 1.617100e-03 (179) = 1.679750e-03/1.542599e-03 (101/78)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, DRIVE expected cell counts
# Expected cell counts: a = 97.232971, b = 81.767029, c = 60030.767029, d = 50482.232971

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, UKBB expected cell counts
# Expected cell counts: a = 26.231520, b = 500.768480, c = 17995.768480, d = 343545.231520

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.12 "" 1 # g2 full-length, DRIVE power
# Power to detect OR = 1.12:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 101 -n 60128 -y 78 -m 50564 -o 1.12 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 5.222352e-06
# OR = 1.120000e+00 (Observed 1.089238e+00, p = 5.992973e-01), power = 1.175003e-01 (1.094000e-01)

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.12 "" 1 # g2 full-length, UKBB power
# Power to detect OR = 1.12:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 62 -n 18022 -y 465 -m 344046 -o 1.12 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.632309e-06
# OR = 1.120000e+00 (Observed 2.555997e+00, p = 5.730024e-10), power = 8.859055e-02 (9.060000e-02)

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies 0.00135156 0.0015426:
# python /home/wletsou/scripts/controls_frequency.py -x1 465 -n1 344046 -x2 78 -n2 50564 -pooled
# p = 2.792347E-01
#
# python /home/wletsou/scripts/controls_frequency2.py -x1 465 -n1 344046 -x2 78 -n2 50564
# p = 2.748421E-01

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh ukbb_permuted.drive.no1kg.pcs.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.combined.g2.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 full-length, combined
# LRT p value = 6.683825e-01 on 1 degree(s) of freedom with OR = 1.120600e+00 (8.788737e-01 to 1.428811e+00), frequency = 1.416200e-03 (644) = 1.679750e-03/1.376042e-03 (101/543)

# sh /home/wletsou/scripts/expected_cell_counts.sh haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" g2, DRIVE expected cell counts
# Expected cell counts: a = 85.153279, b = 558.846721, c = 60042.846721, d = 394051.153279

# /home/wletsou/scripts/fisher_power.sh haplotype_estimates.ukbb_bca_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt haplotype_estimates.dbgap28544_cases.chr11.68850000-69231641.txt,haplotype_estimates.ukbb_bca_controls+dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 "" 1.12 "" 1 # g2 full-length, combined power
# Power to detect OR = 1.12:
# Rscript /home/wletsou/scripts/fisher_power2.R -x 101 -n 60128 -y 543 -m 394610 -o 1.12 -a 0.05 -i
# Warning message:
# In fisher.test(matrix(c(p1 * n1, p2 * n2, (1 - p1) * n1, (1 - p2) *  :
#   'x' has been rounded to integer: Mean relative difference: 4.020862e-06
# OR = 1.120000e+00 (Observed 1.221450e+00, p = 7.068429e-02), power = 1.718000e-01 (1.727000e-01)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3892895_G=1,rs7116054_T=0,rs17149775_G=0,rs10896445_C=1,rs11228599_T=0,rs35637432_A=0,rs11825015_T=0,rs117821797_T=0,rs11539762_A=0,rs7124547_T=1,rs12802601_C=0,rs11263638_A=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g3 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs17149775_G=0,rs117236867_G=0,rs17309046_C=0,rs78033785_T=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs10896445_C=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=1,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g3.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g3 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs3829241_A=0,rs72930631_C=0,rs11228502_C=0,rs3892895_G=1,rs55703863_C=0,rs17149775_G=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs111762835_A=0,rs11228599_T=0,rs35637432_A=0,rs78656034_T=0,rs7103126_C=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs72932198_A=0,rs11263641_C=1" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g4 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs12789955_G=0,rs115223540_T=0,rs28378931_G=0,rs117186144_T=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=1,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g4.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g4 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs1123665_G=0,rs67039008_A=1,rs12275849_C=0,rs7103126_C=1,rs7481709_C=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g5 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=0,rs74674490_G=0,rs72930627_A=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs17308715_T=0,rs67039008_A=1,rs55703863_C=0,rs117236867_G=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=1,rs116926312_T=0,rs142581206_T=0,rs12274095_A=0,rs10896461_G=1,rs78919175_T=0,rs7124547_T=1,rs72932105_T=0,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs12802601_C=0,rs12796465_G=0,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g5.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g5 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs74674490_G=0,rs11228502_C=0,rs3892895_G=1,rs7116054_T=0,rs11228530_C=0,rs78033785_T=0,rs4495899_G=0,rs7103126_C=0,rs11603814_G=1,rs7481709_C=0,rs7102705_G=1,rs11600497_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g6.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g6 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs3892895_G=1,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs17308715_T=0,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs72932540_G=0,rs12418948_T=0,rs78033785_T=0,rs74342245_A=0,rs35435383_A=0,rs4495899_G=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs12224376_A=0,rs11603814_G=1,rs12789955_G=0,rs7481709_C=0,rs115223540_T=0,rs28378931_G=0,rs7102705_G=1,rs117186144_T=0,rs79487139_T=0,rs11600497_A=0,rs72932198_A=0,rs12802601_C=0,rs12796465_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g6.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g6 full-length

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs896973_T=0,rs117694794_T=0,rs61881109_A=0,rs7130881_G=0,rs78656034_T=0,rs7124547_T=0,rs11603814_G=0,rs12789955_G=1,rs7102705_G=0,rs117186144_T=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs11263638_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g7.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g7 reduced

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs74674490_G=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs10896431_T=0,rs7116054_T=0,rs74897859_T=0,rs67039008_A=1,rs55703863_C=0,rs17149775_G=0,rs117236867_G=0,rs11228530_C=0,rs17309046_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs10792029_G=1,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs11228565_A=0,rs7937094_T=0,rs7130881_G=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs11228599_T=0,rs7940107_A=0,rs72930267_T=0,rs7946255_C=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs74551015_A=0,rs117821797_T=0,rs12275849_C=0,rs56103266_C=0,rs117131950_A=0,rs7103126_C=0,rs116926312_T=0,rs11539762_A=0,rs142581206_T=0,rs11228610_C=0,rs12274095_A=0,rs73512137_T=0,rs11601693_A=0,rs12224376_A=0,rs78919175_T=0,rs7124547_T=0,rs11603814_G=0,rs72932105_T=0,rs12789955_G=1,rs115223540_T=0,rs7102705_G=0,rs117186144_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263638_A=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g7.full-length /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g7 full-length


# controls frequency difference

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 full-length, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 465 -n1 344046 -x2 78 -n2 50564 -pooled
# p = 2.792347E-01

# /home/wletsou/scripts/controls_compare.sh /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.ukbb_bca_controls.chr11.68850000-69231641.txt,/scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3/haplotype_estimates.dbgap28544_controls.chr11.68850000-69231641.txt rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0 # g2 reduced, controls p-value
# Test difference in frequencies:
# python /home/wletsou/scripts/controls_frequency.py -x1 467 -n1 344046 -x2 79 -n2 50564 -pooled
# p = 2.468879E-01

# combined controls

# combined controls
# awk 'BEGIN{OFS="\t"} {print $0}' dbgap28544_cases.indiv dbgap28544_controls.indiv ukbb_bca_controls.indiv > dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv
# awk 'NR==FNR{id[$1]; next} (NR!=FNR && FNR==1){print $0} (NR!=FNR && FNR>1 && $1 in id){print $0}' dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.indiv haplotype_estimates.ukbb_bca_cases+ukbb_bca_controls+dbgap28544_cases+dbgap28544_controls.chr11.68850000-69231641.txt > haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt

# /home/wletsou/scripts/dbgap28544_ukbb_phenotype_combine.sh /research_jude/rgs01_jude/groups/yasuigrp/projects/EpiGenetics/common/yasuigrp_data/ProjHap/dbgap28544/topmed/for_william/phenotype/dbgap28544.pheno.txt ukb.bca.pheno.txt

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs2376558_C=1,rs896973_T=0,rs61881030_A=0,rs149949063_G=0,rs144905179_A=0,rs1123665_G=1,rs3829241_A=0,rs72930627_A=0,rs72930631_C=0,rs11228502_C=0,rs12577213_A=0,rs73520512_T=0,rs7116054_T=0,rs74897859_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs35435383_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7937094_T=0,rs7119988_A=0,rs111762835_A=0,rs4930672_A=0,rs116951063_T=0,rs118004919_A=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs117821797_T=0,rs56103266_C=0,rs117131950_A=0,rs116926312_T=0,rs11539762_A=0,rs11228610_C=0,rs12274095_A=0,rs12224376_A=0,rs78919175_T=0,rs72932105_T=0,rs115223540_T=0,rs79487139_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0,rs74471298_A=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 full-length
# LRT p value = 7.343343e-01 on 1 degree(s) of freedom with OR = 1.244287e+00 (1.004719e+00 to 1.540978e+00), frequency = 1.416200e-03 (644) = 1.679750e-03/1.376042e-03 (101/543)

# sh /home/wletsou/scripts/dbgap28544_haplotype_model9_count_fit.sh pheno_combined.txt haplotype_estimates.dbgap28544_cases+dbgap28544_controls+ukbb_bca_controls.chr11.68850000-69231641.txt "rs1123665_G=1,rs72930631_C=0,rs11228502_C=0,rs7116054_T=0,rs55703863_C=0,rs117236867_G=0,rs11228530_C=0,rs56134379_A=0,rs74342245_A=0,rs117694794_T=0,rs78208050_G=0,rs61881109_A=0,rs75590802_A=0,rs7119988_A=0,rs4930672_A=0,rs116951063_T=0,rs35637432_A=0,rs34737133_T=0,rs11825015_T=0,rs78656034_T=0,rs78919175_T=0,rs72932105_T=0,rs72932198_A=0,rs12802601_C=0,rs4275647_T=1,rs61882193_G=0,rs12790064_G=1,rs11263641_C=0,rs76855139_T=0" "1" "rs7105934_A=0,rs79373485_T=0,rs4444099_T=0,rs117752342_T=0,rs1122316_A=0,rs76809977_T=0,rs559664_G=1,rs657315_T=0,rs498931_G=0,rs71465432_T=0,rs183782062_T=0,rs79442425_T=0,rs111929748_T=0,rs117490805_A=0,rs79241527_T=0,rs72932500_G=0,rs57162717_T=0" "1" "" dbgap28544.g2.reduced /scratch_space/wletsou/sjlife/GWAS/UKBB_chr11.34/phase2.3 /home/wletsou/scripts # g2 reduced
# LRT p value = 4.612307e-01 on 1 degree(s) of freedom with OR = 1.297542e+00 (1.052278e+00 to 1.599971e+00), frequency = 1.433793e-03 (652) = 1.762906e-03/1.383645e-03 (106/546)
